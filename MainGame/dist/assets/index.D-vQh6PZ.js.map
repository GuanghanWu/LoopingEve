{"version":3,"file":"index.D-vQh6PZ.js","sources":["../../src/utils/dom.ts","../../src/managers/PlayerManager.ts","../../src/managers/InventoryManager.ts","../../src/managers/StoryManager.ts","../../src/managers/BattleManager.ts","../../src/managers/UIManager.ts","../../src/Game.ts","../../src/main.ts"],"sourcesContent":["export const $ = <T extends HTMLElement = HTMLElement>(id: string): T | null => document.getElementById(id) as T | null;\n","import type { Game } from '../Game';\nimport type { Skill } from '../types';\n\nexport class PlayerManager {\n  private game: Game;\n\n  constructor(game: Game) {\n    this.game = game;\n  }\n\n  init(): void {\n    this.game.player = {\n      ...this.game.config.player.initial,\n      weapon: null,\n      armor: null,\n      learnedSkills: ['powerStrike'],\n      equippedSkills: ['powerStrike'],\n      selectedSkill: 'powerStrike',\n      skillCooldowns: {}\n    };\n  }\n\n  getTotalAtk(): number {\n    let atk = this.game.player.atk;\n    if (this.game.player.weapon) {\n      const weapon = this.game.config.equipment.weapons.find(w => w.id === this.game.player.weapon);\n      if (weapon) atk += weapon.atk;\n    }\n    return atk;\n  }\n\n  getTotalDef(): number {\n    let def = this.game.player.def;\n    if (this.game.player.armor) {\n      const armor = this.game.config.equipment.armors.find(a => a.id === this.game.player.armor);\n      if (armor) def += armor.def;\n    }\n    return def;\n  }\n\n  getUnlockedSkillSlots(): number {\n    const level = this.game.player.level;\n    return this.game.config.player.skillSlots.filter(lvl => level >= lvl).length;\n  }\n\n  levelUp(): void {\n    const cfg = this.game.config.player.levelUp;\n    while (this.game.player.exp >= this.game.player.maxEXP) {\n      this.game.player.exp -= this.game.player.maxEXP;\n      this.game.player.level++;\n      this.game.player.maxHP += cfg.hp;\n      this.game.player.hp = Math.min(this.game.player.hp + cfg.hp, this.game.player.maxHP);\n      this.game.player.atk += cfg.atk;\n      this.game.player.def += cfg.def;\n      this.game.player.maxEXP = Math.floor(this.game.player.maxEXP * cfg.expMultiplier);\n      this.game.ui.showLevelUp(this.game.player.level, cfg);\n    }\n  }\n\n  equipSkill(skillId: string): string | null {\n    const equipped = this.game.player.equippedSkills;\n    if (equipped.includes(skillId)) return null;\n    const unlocked = this.getUnlockedSkillSlots();\n    let replacedSkill: string | null = null;\n    if (equipped.length >= unlocked) {\n      if (equipped[0]) {\n        const oldSkill = this.game.config.skills.find(s => s.id === equipped[0]);\n        replacedSkill = oldSkill ? oldSkill.name : equipped[0];\n        equipped.shift();\n      }\n    }\n    equipped.push(skillId);\n    return replacedSkill;\n  }\n\n  unequipSkill(index: number): boolean {\n    if (index < 0 || index >= this.game.player.equippedSkills.length) return false;\n    this.game.player.equippedSkills.splice(index, 1);\n    return true;\n  }\n\n  checkSkillUnlock(): void {\n    const level = this.game.player.level;\n    this.game.config.skills.forEach((skill: Skill) => {\n      if (this.game.player.learnedSkills.includes(skill.id)) return;\n      if (skill.unlock === 'default' || skill.unlock === 'scroll') return;\n      const levelMatch = skill.unlock.match(/^level(\\d+)$/);\n      if (levelMatch && level >= parseInt(levelMatch[1])) {\n        this.game.player.learnedSkills.push(skill.id);\n        this.game.ui.log(`âœ¨ å­¦ä¼šæ–°æŠ€èƒ½ï¼š${skill.icon} ${skill.name}ï¼`);\n        if (!this.game.player.equippedSkills.includes(skill.id)) {\n          const slots = this.getUnlockedSkillSlots();\n          if (this.game.player.equippedSkills.length < slots) {\n            this.game.player.equippedSkills.push(skill.id);\n          }\n        }\n      }\n    });\n  }\n\n  reduceCooldowns(): void {\n    Object.keys(this.game.player.skillCooldowns).forEach((key: string) => {\n      if (this.game.player.skillCooldowns[key] > 0) {\n        this.game.player.skillCooldowns[key]--;\n      }\n    });\n    this.game.ui.updateSkillName();\n  }\n\n  migrateOldData(): void {\n    if (!this.game.player.learnedSkills) {\n      this.game.player.learnedSkills = ['powerStrike'];\n      this.game.player.equippedSkills = ['powerStrike'];\n      this.game.player.skillCooldowns = {};\n    }\n    if (!this.game.player.selectedSkill) {\n      this.game.player.selectedSkill = this.game.player.learnedSkills[0] || 'powerStrike';\n    }\n    if (!this.game.player.weapon) this.game.player.weapon = null;\n    if (!this.game.player.armor) this.game.player.armor = null;\n  }\n\n  unequipItem(category: 'weapons' | 'armors'): void {\n    if (category === 'weapons') {\n      this.game.player.weapon = null;\n    } else {\n      this.game.player.armor = null;\n    }\n  }\n}\n","import type { Game } from '../Game';\nimport type { ConsumableItem, ScrollItem, Weapon, Armor } from '../types';\n\nexport class InventoryManager {\n  private game: Game;\n\n  constructor(game: Game) {\n    this.game = game;\n  }\n\n  init(): void {\n    this.game.inventory = {\n      slots: this.game.config.inventory.initialSlots,\n      items: []\n    };\n  }\n\n  addItem(itemId: string, count: number = 1): void {\n    const allItems = [\n      ...this.game.config.items.consumables,\n      ...this.game.config.items.materials,\n      ...this.game.config.items.scrolls\n    ];\n    const itemDef = allItems.find(i => i.id === itemId);\n    if (!itemDef) return;\n    const existing = this.game.inventory.items.find(i => i.id === itemId);\n    if (existing) {\n      const newCount = Math.min(existing.count + count, itemDef.stackMax);\n      const added = newCount - existing.count;\n      existing.count = newCount;\n      if (added > 0) {\n        this.game.ui.log(`ğŸ“¦ ${itemDef.icon} ${itemDef.name} +${added}`);\n      }\n    } else {\n      if (this.game.inventory.items.length >= this.game.inventory.slots) {\n        this.game.ui.log(`âš ï¸ èƒŒåŒ…å·²æ»¡ï¼Œ${itemDef.name} ä¸¢å¤±ï¼`);\n        return;\n      }\n      this.game.inventory.items.push({ id: itemId, count: Math.min(count, itemDef.stackMax) });\n      this.game.ui.log(`ğŸ“¦ ${itemDef.icon} ${itemDef.name} +${count}`);\n    }\n  }\n\n  removeItem(itemId: string, count: number = 1): boolean {\n    const idx = this.game.inventory.items.findIndex(i => i.id === itemId);\n    if (idx === -1) return false;\n    this.game.inventory.items[idx].count -= count;\n    if (this.game.inventory.items[idx].count <= 0) {\n      this.game.inventory.items.splice(idx, 1);\n    }\n    return true;\n  }\n\n  getItemCount(itemId: string): number {\n    const item = this.game.inventory.items.find(i => i.id === itemId);\n    return item ? item.count : 0;\n  }\n\n  grantLoot(monsterId: string): void {\n    const lootTable = this.game.config.lootTable[monsterId];\n    if (!lootTable) return;\n    lootTable.forEach(loot => {\n      if (Math.random() < loot.rate) {\n        const count = Math.floor(Math.random() * (loot.maxCount - loot.minCount + 1)) + loot.minCount;\n        this.addItem(loot.itemId, count);\n      }\n    });\n  }\n\n  useItem(index: number): void {\n    const item = this.game.inventory.items[index];\n    if (!item) return;\n    const def = this.game.config.items.consumables.find((d: ConsumableItem) => d.id === item.id);\n    if (!def || !def.heal) return;\n    const healAmt = Math.min(def.heal, this.game.player.maxHP - this.game.player.hp);\n    if (healAmt <= 0) return;\n    this.game.player.hp += healAmt;\n    this.removeItem(item.id, 1);\n    this.game.ui.log(`ğŸ’š ä½¿ç”¨ ${def.name}ï¼Œæ¢å¤ <span class=\"heal\">${healAmt}</span> HP`);\n    this.game.save();\n    this.game.ui.render();\n    this.game.ui.renderInventoryPanel();\n  }\n\n  useItemInBattle(itemId: string): void {\n    if (!this.game.inBattle) return;\n    const def = this.game.config.items.consumables.find((d: ConsumableItem) => d.id === itemId);\n    if (!def || !def.heal) return;\n    const healAmt = Math.min(def.heal, this.game.player.maxHP - this.game.player.hp);\n    this.game.player.hp += healAmt;\n    this.removeItem(itemId, 1);\n    this.game.ui.log(`ğŸ’š ä½¿ç”¨ ${def.name}ï¼Œæ¢å¤ <span class=\"heal\">${healAmt}</span> HP`);\n    this.game.ui.showDamagePopup(healAmt, true);\n    document.getElementById('itemModal')?.classList.remove('show');\n    this.game.save();\n    this.game.ui.render();\n    this.game.battle.enemyAttack();\n  }\n\n  smartUseItem(): void {\n    if (!this.game.inBattle) {\n      this.game.ui.log('âŒ éæˆ˜æ–—çŠ¶æ€ï¼');\n      return;\n    }\n    const missingHP = this.game.player.maxHP - this.game.player.hp;\n    if (missingHP < 2) {\n      this.game.ui.log('ğŸ’š æ— éœ€æ¢å¤è¡€é‡ï¼');\n      return;\n    }\n    const hpPercent = this.game.player.hp / this.game.player.maxHP;\n    const consumables = this.game.inventory.items\n      .filter(i => {\n        const def = this.game.config.items.consumables.find((d: ConsumableItem) => d.id === i.id);\n        return def && def.heal;\n      })\n      .map(i => {\n        const def = this.game.config.items.consumables.find((d: ConsumableItem) => d.id === i.id);\n        return { ...i, def, heal: def!.heal };\n      })\n      .sort((a, b) => b.heal - a.heal);\n\n    if (consumables.length === 0) {\n      this.game.ui.log('âŒ æ²¡æœ‰å¯ç”¨çš„é“å…·ï¼');\n      return;\n    }\n\n    let selectedItem: { id: string; heal: number } | null = null;\n    if (hpPercent < 0.3) {\n      selectedItem = consumables[0];\n    } else {\n      for (const item of consumables) {\n        if (item.heal >= missingHP * 0.5) {\n          selectedItem = item;\n          break;\n        }\n      }\n      if (!selectedItem) {\n        selectedItem = consumables[consumables.length - 1];\n      }\n    }\n\n    this.useItemInBattle(selectedItem.id);\n  }\n\n  learnScroll(index: number): void {\n    const item = this.game.inventory.items[index];\n    if (!item) return;\n    const def = this.game.config.items.scrolls.find((d: ScrollItem) => d.id === item.id);\n    if (!def || !def.skill) return;\n    if (this.game.player.learnedSkills.includes(def.skill)) return;\n    this.game.player.learnedSkills.push(def.skill);\n    this.removeItem(item.id, 1);\n    const skill = this.game.config.skills.find(s => s.id === def!.skill);\n    this.game.ui.log(`âœ¨ å­¦ä¼šæ–°æŠ€èƒ½ï¼š${skill!.icon} ${skill!.name}ï¼`);\n    this.game.save();\n    this.game.ui.renderInventoryPanel();\n  }\n\n  getUnlockCost(): number {\n    const unlocked = this.game.inventory.slots - this.game.config.inventory.initialSlots;\n    return Math.floor(\n      this.game.config.inventory.unlockCostBase *\n        Math.pow(this.game.config.inventory.unlockCostMultiplier, unlocked)\n    );\n  }\n\n  unlockSlot(): void {\n    if (this.game.inventory.slots >= this.game.config.inventory.maxSlots) return;\n    const cost = this.getUnlockCost();\n    if (this.game.player.gold < cost) {\n      this.game.ui.log('âŒ é‡‘å¸ä¸è¶³ï¼');\n      return;\n    }\n    this.game.player.gold -= cost;\n    this.game.inventory.slots++;\n    this.game.ui.log(`ğŸ”“ èƒŒåŒ…æ‰©å……è‡³ ${this.game.inventory.slots} æ ¼ï¼`);\n    this.game.save();\n    this.game.ui.render();\n    this.game.ui.renderInventoryPanel();\n  }\n\n  canForge(item: Weapon | Armor): boolean {\n    return Object.entries(item.materials).every(([matId, count]) => {\n      return this.getItemCount(matId) >= count;\n    });\n  }\n\n  forgeItem(category: 'weapons' | 'armors', itemId: string): void {\n    const item = this.game.config.equipment[category].find(i => i.id === itemId);\n    if (!item) return;\n    if (!this.canForge(item)) return;\n    Object.entries(item.materials).forEach(([matId, count]) => {\n      this.removeItem(matId, count);\n    });\n    if (category === 'weapons') {\n      this.game.player.weapon = itemId;\n    } else {\n      this.game.player.armor = itemId;\n    }\n    this.game.ui.log(`ğŸ”¨ é”»é€ æˆåŠŸï¼š${item.icon} ${item.name}ï¼`);\n    this.game.save();\n    this.game.ui.render();\n    this.game.ui.showForgeCategory(category);\n  }\n}\n","import type { Game } from '../Game';\nimport type { WorldLore, NPC, RandomEvent, StorySaveData } from '../types';\n\ninterface RewardResult {\n  gold: number;\n  exp: number;\n  items: { itemId: string; count: number }[];\n  heal: number;\n  lore: string | null;\n}\n\nexport class StoryManager {\n  private game: Game;\n  private seenLore: Set<string>;\n  private seenNPCs: Set<string>;\n  private triggeredEvents: Set<string>;\n\n  constructor(game: Game) {\n    this.game = game;\n    this.seenLore = new Set();\n    this.seenNPCs = new Set();\n    this.triggeredEvents = new Set();\n  }\n\n  getWorldLore(floor: number): WorldLore {\n    const loreList = this.game.config.worldLore;\n    for (const lore of loreList) {\n      if (floor >= lore.floorRange[0] && floor <= lore.floorRange[1]) {\n        return lore;\n      }\n    }\n    return loreList[0];\n  }\n\n  onFloorAdvance(newFloor: number, _oldFloor: number): { type: string; data: WorldLore; floor: number } | null {\n    const lore = this.getWorldLore(newFloor);\n    const loreKey = `floor_${newFloor}`;\n    const isFirstVisit = !this.seenLore.has(loreKey);\n\n    if (isFirstVisit) {\n      this.seenLore.add(loreKey);\n      return { type: 'lore', data: lore, floor: newFloor };\n    }\n    return null;\n  }\n\n  checkNPC(floor: number): { type: string; data: NPC } | null {\n    const npcs = this.game.config.npcs;\n    const availableNPCs = npcs.filter(\n      npc => floor >= npc.minFloor && !this.seenNPCs.has(`${npc.id}_${floor}`)\n    );\n\n    for (const npc of availableNPCs) {\n      if (Math.random() < npc.probability) {\n        this.seenNPCs.add(`${npc.id}_${floor}`);\n        return { type: 'npc', data: npc };\n      }\n    }\n    return null;\n  }\n\n  checkRandomEvent(floor: number): { type: string; data: RandomEvent } | null {\n    const events = this.game.config.randomEvents;\n    const availableEvents = events.filter(event => floor >= event.minFloor);\n\n    for (const event of availableEvents) {\n      const eventKey = `${event.id}_${Date.now()}`;\n      if (Math.random() < event.probability) {\n        this.triggeredEvents.add(eventKey);\n        return { type: 'event', data: event };\n      }\n    }\n    return null;\n  }\n\n  processEventReward(event: RandomEvent): RewardResult {\n    const reward = event.reward;\n    const outcomes = event.outcomes;\n    const effects = event.effect;\n\n    const result: RewardResult = { gold: 0, exp: 0, items: [], heal: 0, lore: null };\n\n    if (reward) {\n      if (reward.gold) result.gold = reward.gold;\n      if (reward.exp) result.exp = reward.exp;\n      if (reward.itemId) {\n        result.items.push({ itemId: reward.itemId, count: 1 });\n      }\n    }\n\n    if (outcomes && outcomes.length > 0) {\n      const totalWeight = outcomes.reduce((sum, o) => sum + o.weight, 0);\n      let random = Math.random() * totalWeight;\n      for (const outcome of outcomes) {\n        random -= outcome.weight;\n        if (random <= 0) {\n          if (outcome.gold) result.gold = outcome.gold;\n          if (outcome.itemId) {\n            result.items.push({ itemId: outcome.itemId, count: 1 });\n          }\n          break;\n        }\n      }\n    }\n\n    if (effects && effects.length > 0) {\n      const totalWeight = effects.reduce((sum, e) => sum + e.weight, 0);\n      let random = Math.random() * totalWeight;\n      for (const effect of effects) {\n        random -= effect.weight;\n        if (random <= 0) {\n          if (effect.type === 'heal') result.heal = effect.value;\n          if (effect.type === 'gold') result.gold = effect.value;\n          if (effect.type === 'exp') result.exp = effect.value;\n          break;\n        }\n      }\n    }\n\n    if (event.lore) {\n      if (Array.isArray(event.lore)) {\n        result.lore = event.lore[Math.floor(Math.random() * event.lore.length)];\n      } else {\n        result.lore = event.lore;\n      }\n    }\n\n    return result;\n  }\n\n  processNPCReward(npc: NPC): RewardResult {\n    const reward = npc.reward;\n    const result: RewardResult = { gold: 0, exp: 0, items: [], heal: 0, lore: null };\n\n    if (reward) {\n      if (reward.gold) result.gold = reward.gold;\n      if (reward.exp) result.exp = reward.exp;\n      if (reward.itemId) {\n        result.items.push({ itemId: reward.itemId, count: 1 });\n      }\n    }\n\n    return result;\n  }\n\n  applyReward(result: RewardResult): void {\n    if (result.gold && result.gold > 0) {\n      this.game.player.gold += result.gold;\n    }\n    if (result.exp && result.exp > 0) {\n      this.game.player.exp += result.exp;\n      this.game.playerManager.levelUp();\n    }\n    if (result.items && result.items.length > 0) {\n      result.items.forEach(item => {\n        this.game.inventoryManager.addItem(item.itemId, item.count);\n      });\n    }\n    if (result.heal && result.heal > 0) {\n      const actualHeal = Math.min(result.heal, this.game.player.maxHP - this.game.player.hp);\n      this.game.player.hp += actualHeal;\n    }\n  }\n\n  getNPCDialogue(npc: NPC): string {\n    if (npc.dialogues && npc.dialogues.length > 0) {\n      return npc.dialogues[Math.floor(Math.random() * npc.dialogues.length)];\n    }\n    return npc.greeting;\n  }\n\n  hasStoryContent(): boolean {\n    return this.seenLore.size > 0;\n  }\n\n  hasWorldLore(): boolean {\n    return true;\n  }\n\n  hasNPCInteraction(): boolean {\n    return this.seenNPCs.size > 0;\n  }\n\n  reset(): void {\n    this.seenLore.clear();\n    this.seenNPCs.clear();\n    this.triggeredEvents.clear();\n  }\n\n  save(): StorySaveData {\n    return {\n      seenLore: Array.from(this.seenLore),\n      seenNPCs: Array.from(this.seenNPCs),\n      triggeredEvents: Array.from(this.triggeredEvents)\n    };\n  }\n\n  load(data: StorySaveData | undefined): void {\n    if (data) {\n      this.seenLore = new Set(data.seenLore || []);\n      this.seenNPCs = new Set(data.seenNPCs || []);\n    }\n  }\n}\n","import type { Game } from '../Game';\nimport type { MonsterInstance, Skill } from '../types';\n\nexport class BattleManager {\n  private game: Game;\n\n  constructor(game: Game) {\n    this.game = game;\n  }\n\n  createMonster(): MonsterInstance {\n    const cfg = this.game.config.floor;\n    const monsters = this.game.config.monsters.filter(m => m.minFloor <= this.game.floor);\n    const idx = Math.floor(Math.random() * monsters.length);\n    const m = monsters[idx];\n    const mult = 1 + (this.game.floor - 1) * cfg.difficultyMultiplier;\n    return {\n      id: m.id,\n      name: m.name,\n      avatar: m.avatar,\n      hp: Math.floor(m.hp * mult),\n      maxHP: Math.floor(m.hp * mult),\n      atk: Math.floor(m.atk * mult),\n      def: Math.floor(m.def * mult),\n      exp: Math.floor(m.exp * mult),\n      gold: Math.floor(m.gold * mult),\n      critRate: m.critRate ?? 0.10,\n      dodgeRate: m.dodgeRate ?? 0.05\n    };\n  }\n\n  explore(): void {\n    if (this.game.inBattle) return;\n    this.game.monster = this.createMonster();\n    this.game.inBattle = true;\n    this.game.slowEffect = 0;\n    this.game.ui.log(`é­é‡äº† ${this.game.monster.avatar} ${this.game.monster.name}ï¼`);\n    this.game.ui.setButtons({ attack: false, skill: false, item: false, inventory: false, next: true });\n    this.game.ui.renderMonster();\n  }\n\n  calcDamage(atk: number, def: number, rand: number): number {\n    return Math.max(1, Math.floor(atk - def + Math.random() * rand));\n  }\n\n  attack(): void {\n    if (!this.game.inBattle) return;\n    const dmg = this.calcDamage(\n      this.game.playerManager.getTotalAtk(),\n      this.game.monster!.def,\n      this.game.config.battle.normalAttackRand\n    );\n    this.dealDamage(dmg, `å¯¹ ${this.game.monster!.name} é€ æˆ `);\n  }\n\n  useSkill(skillId: string): void {\n    if (!this.game.inBattle) return;\n    const skill = this.game.config.skills.find((s: Skill) => s.id === skillId);\n    if (!skill) return;\n    if (this.game.player.skillCooldowns[skillId] > 0) {\n      this.game.ui.log(`â³ ${skill.name} å†·å´ä¸­ï¼`);\n      return;\n    }\n    this.game.player.skillCooldowns[skillId] = skill.cd;\n    this.game.ui.updateSkillName();\n    if (skill.type === 'attack') {\n      const dmg = this.calcDamage(\n        this.game.playerManager.getTotalAtk() * (skill.damageMultiplier ?? 1),\n        this.game.monster!.def,\n        skill.damageRand ?? 0\n      );\n      const msg = `${skill.icon} ${skill.name}ï¼å¯¹ ${this.game.monster!.name} é€ æˆ `;\n      this.dealDamage(dmg, msg, skill);\n    } else if (skill.type === 'heal') {\n      const healAmt = Math.floor(this.game.player.maxHP * (skill.healPercent ?? 0));\n      this.game.player.hp = Math.min(this.game.player.hp + healAmt, this.game.player.maxHP);\n      this.game.ui.log(`${skill.icon} ${skill.name}ï¼æ¢å¤ <span class=\"heal\">${healAmt}</span> HP`);\n      this.game.ui.showDamagePopup(healAmt, true);\n      this.game.ui.render();\n      this.enemyAttack();\n    }\n  }\n\n  useSelectedSkill(): void {\n    const skillId = this.game.player.selectedSkill || this.game.player.learnedSkills[0];\n    if (!skillId) {\n      this.game.ui.log('âŒ æ²¡æœ‰å­¦ä¼šæŠ€èƒ½ï¼');\n      return;\n    }\n    const cd = this.game.player.skillCooldowns[skillId] || 0;\n    if (cd > 0) {\n      const skill = this.game.config.skills.find((s: Skill) => s.id === skillId);\n      this.game.ui.log(`â³ ${skill!.name} å†·å´ä¸­ (${cd}å›åˆ)ï¼`);\n      return;\n    }\n    this.useSkill(skillId);\n  }\n\n  dealDamage(dmg: number, msg: string, skill: Skill | null = null): void {\n    const playerCritRate = this.game.player.critRate ?? this.game.config.player.initial.critRate;\n    const monsterDodgeRate = this.game.monster!.dodgeRate ?? 0.05;\n\n    if (Math.random() < monsterDodgeRate) {\n      this.game.ui.log(`${this.game.monster!.avatar} ${this.game.monster!.name} é—ªé¿äº†æ”»å‡»ï¼`);\n      this.game.ui.showDamagePopup(0, false, true);\n      this.enemyAttack();\n      this.game.ui.render();\n      return;\n    }\n\n    const isCritical = Math.random() < playerCritRate;\n    let finalDmg = dmg;\n    if (isCritical) {\n      finalDmg = Math.floor(dmg * 1.5);\n    }\n\n    this.game.monster!.hp -= finalDmg;\n    const critText = isCritical ? 'ğŸ’¥ æš´å‡»ï¼' : '';\n    this.game.ui.log(`${msg}<span class=\"damage\">${finalDmg}</span> ä¼¤å®³ï¼${critText}`);\n    this.game.ui.showDamagePopup(finalDmg, false, false, isCritical);\n    this.game.ui.flash('.monster-card');\n    if (skill && skill.slow) {\n      this.game.slowEffect = skill.slow;\n      this.game.ui.log(`â„ï¸ æ€ªç‰©è¢«å‡é€Ÿï¼`);\n    }\n    if (skill && skill.lifesteal) {\n      const healAmt = Math.floor(finalDmg * skill.lifesteal);\n      this.game.player.hp = Math.min(this.game.player.hp + healAmt, this.game.player.maxHP);\n      this.game.ui.log(`ğŸ©¸ å¸è¡€æ¢å¤ <span class=\"heal\">${healAmt}</span> HP`);\n      this.game.ui.showDamagePopup(healAmt, true);\n    }\n    this.game.ui.renderMonster();\n    if (this.game.monster!.hp <= 0) {\n      this.defeat();\n    } else {\n      this.enemyAttack();\n    }\n    this.game.ui.render();\n  }\n\n  enemyAttack(): void {\n    let atk = this.game.monster!.atk;\n    if (this.game.slowEffect > 0) {\n      atk = Math.floor(atk * (1 - this.game.slowEffect));\n      this.game.slowEffect = Math.max(0, this.game.slowEffect - 0.1);\n    }\n\n    const playerDodgeRate = this.game.player.dodgeRate ?? this.game.config.player.initial.dodgeRate;\n    if (Math.random() < playerDodgeRate) {\n      this.game.ui.log(`ğŸ’« ä½ é—ªé¿äº† ${this.game.monster!.name} çš„æ”»å‡»ï¼`);\n      return;\n    }\n\n    const monsterCritRate = this.game.monster!.critRate ?? 0.10;\n    const isCritical = Math.random() < monsterCritRate;\n\n    let dmg = this.calcDamage(\n      atk,\n      this.game.playerManager.getTotalDef(),\n      this.game.config.battle.enemyAttackRand\n    );\n    if (isCritical) {\n      dmg = Math.floor(dmg * 1.5);\n    }\n\n    this.game.player.hp -= dmg;\n    const critText = isCritical ? 'ğŸ’¥ æš´å‡»ï¼' : '';\n    this.game.ui.log(\n      `${this.game.monster!.avatar} ${this.game.monster!.name} å¯¹ä½ é€ æˆ <span class=\"damage\">${dmg}</span> ä¼¤å®³ï¼${critText}`\n    );\n    this.game.ui.flash('.status-bar');\n    if (this.game.player.hp <= 0) this.game.gameOver();\n  }\n\n  defeat(): void {\n    this.game.inBattle = false;\n    this.game.killed++;\n    this.game.player.exp += this.game.monster!.exp;\n    this.game.player.gold += this.game.monster!.gold;\n    this.game.ui.log(\n      `ğŸ‰ å‡»è´¥ ${this.game.monster!.name}ï¼+<span class=\"exp\">${this.game.monster!.exp}</span> ç»éªŒ +<span class=\"gold\">${this.game.monster!.gold}</span> é‡‘å¸`\n    );\n    this.game.inventoryManager.grantLoot(this.game.monster!.id);\n    this.game.playerManager.reduceCooldowns();\n    this.game.playerManager.checkSkillUnlock();\n    this.game.playerManager.levelUp();\n\n    const randomEvent = this.game.storyManager.checkRandomEvent(this.game.floor);\n    if (randomEvent) {\n      const result = this.game.storyManager.processEventReward(randomEvent.data);\n      this.game.storyManager.applyReward(result);\n      setTimeout(() => {\n        this.game.ui.showEventModal(randomEvent.data, result);\n      }, 500);\n    }\n\n    this.game.save();\n    this.game.ui.updatePostBattleUI();\n    this.game.handleAutoNext();\n  }\n}\n","import { $ } from '../utils/dom';\nimport type { Game } from '../Game';\nimport type {\n  WorldLore,\n  NPC,\n  RandomEvent,\n  Skill,\n  ConsumableItem,\n  ScrollItem,\n  Weapon,\n  Armor\n} from '../types';\n\ninterface RewardResult {\n  gold: number;\n  exp: number;\n  items: { itemId: string; count: number }[];\n  heal: number;\n  lore: string | null;\n}\n\ninterface ButtonState {\n  attack: boolean;\n  skill: boolean;\n  item: boolean;\n  inventory: boolean;\n  next: boolean;\n}\n\nexport class UIManager {\n  private game: Game;\n\n  constructor(game: Game) {\n    this.game = game;\n  }\n\n  log(msg: string): void {\n    const log = $('battleLog');\n    if (!log) return;\n    const p = document.createElement('p');\n    p.innerHTML = msg;\n    log.appendChild(p);\n    log.scrollTop = log.scrollHeight;\n    const firstChild = log.firstChild;\n    if (log.children.length > 15 && firstChild) {\n      log.removeChild(firstChild);\n    }\n  }\n\n  flash(sel: string): void {\n    const el = document.querySelector(sel);\n    if (!el) return;\n    el.classList.add('shake');\n    setTimeout(() => el.classList.remove('shake'), 300);\n  }\n\n  showDamagePopup(value: number, isHeal: boolean, isDodge: boolean = false, isCritical: boolean = false): void {\n    const popup = document.createElement('div');\n    let className = 'damage-popup';\n    if (isHeal) className += ' heal-popup';\n    if (isDodge) className += ' dodge-popup';\n    if (isCritical) className += ' critical-popup';\n    popup.className = className;\n\n    if (isDodge) {\n      popup.textContent = 'MISS';\n    } else {\n      popup.textContent = (isHeal ? '+' : '-') + value + (isCritical ? '!' : '');\n    }\n\n    const monsterCard = document.querySelector('.monster-card');\n    if (monsterCard) {\n      const rect = monsterCard.getBoundingClientRect();\n      popup.style.left = rect.left + rect.width / 2 - 20 + Math.random() * 40 + 'px';\n      popup.style.top = rect.top + rect.height / 3 + 'px';\n    }\n    document.body.appendChild(popup);\n    setTimeout(() => popup.remove(), 800);\n  }\n\n  render(): void {\n    const p = this.game.player;\n    const playerLevel = $('playerLevel');\n    const playerHP = $('playerHP');\n    const playerMaxHP = $('playerMaxHP');\n    const playerATK = $('playerATK');\n    const playerDEF = $('playerDEF');\n    const playerEXP = $('playerEXP');\n    const playerMaxEXP = $('playerMaxEXP');\n    const playerGold = $('playerGold');\n    const currentFloor = $('currentFloor');\n    const hpFill = $('hpFill');\n    const expBar = $('expBar');\n\n    if (playerLevel) playerLevel.textContent = String(p.level);\n    if (playerHP) playerHP.textContent = String(p.hp);\n    if (playerMaxHP) playerMaxHP.textContent = String(p.maxHP);\n    if (playerATK) playerATK.textContent = String(this.game.playerManager.getTotalAtk());\n    if (playerDEF) playerDEF.textContent = String(this.game.playerManager.getTotalDef());\n    if (playerEXP) playerEXP.textContent = String(p.exp);\n    if (playerMaxEXP) playerMaxEXP.textContent = String(p.maxEXP);\n    if (playerGold) playerGold.textContent = String(this.game.player.gold);\n    if (currentFloor) currentFloor.textContent = String(this.game.floor);\n\n    const hpPercent = Math.max(0, (p.hp / p.maxHP) * 100);\n    const expPercent = Math.max(0, (p.exp / p.maxEXP) * 100);\n    if (hpFill) (hpFill as HTMLElement).style.width = `${hpPercent}%`;\n    if (expBar) (expBar as HTMLElement).style.width = `${expPercent}%`;\n\n    this.renderKillProgress();\n    this.renderEquipment();\n  }\n\n  renderKillProgress(): void {\n    const target = this.game.getMonstersToAdvance();\n    const displayKilled = Math.min(this.game.killed, target);\n    const progressEl = $('killProgress');\n    if (!progressEl) return;\n    progressEl.textContent = `${displayKilled}/${target}`;\n    if (this.game.killed >= target) {\n      progressEl.classList.add('complete');\n    } else {\n      progressEl.classList.remove('complete');\n    }\n  }\n\n  renderEquipment(): void {\n    const weaponEl = $('playerWeapon');\n    const armorEl = $('playerArmor');\n    if (this.game.player.weapon) {\n      const w = this.game.config.equipment.weapons.find((we: Weapon) => we.id === this.game.player.weapon);\n      if (weaponEl) weaponEl.textContent = w ? w.name : 'æ— ';\n    } else {\n      if (weaponEl) weaponEl.textContent = 'æ— ';\n    }\n    if (this.game.player.armor) {\n      const a = this.game.config.equipment.armors.find((ar: Armor) => ar.id === this.game.player.armor);\n      if (armorEl) armorEl.textContent = a ? a.name : 'æ— ';\n    } else {\n      if (armorEl) armorEl.textContent = 'æ— ';\n    }\n  }\n\n  renderMonster(): void {\n    if (!this.game.monster) return;\n    const monsterAvatar = $('monsterAvatar');\n    const monsterName = $('monsterName');\n    const monsterHP = $('monsterHP');\n    const monsterMaxHP = $('monsterMaxHP');\n    const monsterHPFill = $('monsterHPFill');\n\n    if (monsterAvatar) monsterAvatar.textContent = this.game.monster.avatar;\n    if (monsterName) monsterName.textContent = this.game.monster.name;\n    if (monsterHP) monsterHP.textContent = String(Math.max(0, this.game.monster.hp));\n    if (monsterMaxHP) monsterMaxHP.textContent = String(this.game.monster.maxHP);\n    if (monsterHPFill) {\n      (monsterHPFill as HTMLElement).style.width = `${Math.max(0, (this.game.monster.hp / this.game.monster.maxHP) * 100)}%`;\n    }\n  }\n\n  setButtons({ attack, skill, item, next }: ButtonState): void {\n    const btnAttack = $<HTMLButtonElement>('btnAttack');\n    const btnSkill = $<HTMLButtonElement>('btnSkill');\n    const btnItem = $<HTMLButtonElement>('btnItem');\n    const btnNextFloor = $<HTMLButtonElement>('btnNextFloor');\n\n    if (btnAttack) btnAttack.disabled = attack;\n    if (btnSkill) btnSkill.disabled = skill;\n    if (btnItem) btnItem.disabled = item;\n    if (btnNextFloor) {\n      const shouldDisableNext = next && !this.game.canAdvanceFloor;\n      btnNextFloor.disabled = shouldDisableNext;\n      if (this.game.canAdvanceFloor && !next) {\n        btnNextFloor.classList.add('can-advance');\n      } else {\n        btnNextFloor.classList.remove('can-advance');\n      }\n    }\n  }\n\n  updatePostBattleUI(): void {\n    this.game.canAdvanceFloor = this.game.killed >= this.game.getMonstersToAdvance();\n    this.setButtons({\n      attack: true,\n      skill: true,\n      item: true,\n      inventory: false,\n      next: !this.game.canAdvanceFloor\n    });\n  }\n\n  updateSkillName(): void {\n    const skillId = this.game.player.selectedSkill || this.game.player.learnedSkills[0];\n    const btn = $<HTMLButtonElement>('btnSkill');\n    const currentSkillName = $('currentSkillName');\n\n    if (btn && currentSkillName) {\n      if (skillId) {\n        const skill = this.game.config.skills.find((s: Skill) => s.id === skillId);\n        if (skill) {\n          const cd = this.game.player.skillCooldowns[skillId] || 0;\n          if (cd > 0) {\n            currentSkillName.textContent = `${skill.name} (CD:${cd})`;\n            btn.classList.add('on-cooldown');\n          } else {\n            currentSkillName.textContent = skill.name;\n            btn.classList.remove('on-cooldown');\n          }\n          return;\n        }\n      }\n      currentSkillName.textContent = 'æ— æŠ€èƒ½';\n      btn.classList.remove('on-cooldown');\n    }\n  }\n\n  showLevelUp(level: number, cfg: { hp: number; atk: number; def: number }): void {\n    const newLevel = $('newLevel');\n    const levelUpHP = $('levelUpHP');\n    const levelUpATK = $('levelUpATK');\n    const levelUpDEF = $('levelUpDEF');\n    const levelUpModal = $('levelUpModal');\n\n    if (newLevel) newLevel.textContent = String(level);\n    if (levelUpHP) levelUpHP.textContent = `+${cfg.hp}`;\n    if (levelUpATK) levelUpATK.textContent = `+${cfg.atk}`;\n    if (levelUpDEF) levelUpDEF.textContent = `+${cfg.def}`;\n    if (levelUpModal) levelUpModal.classList.add('show');\n  }\n\n  closeLevelUpModal(): void {\n    const levelUpModal = $('levelUpModal');\n    if (levelUpModal) levelUpModal.classList.remove('show');\n  }\n\n  openInventory(): void {\n    this.renderInventoryPanel();\n    const inventoryModal = $('inventoryModal');\n    if (inventoryModal) inventoryModal.classList.add('show');\n  }\n\n  renderInventoryPanel(): void {\n    const allItems = [\n      ...this.game.config.items.consumables,\n      ...this.game.config.items.materials,\n      ...this.game.config.items.scrolls\n    ];\n    let html = `<div class=\"inventory-header\">\n      <span>ğŸ’ èƒŒåŒ… (${this.game.inventory.items.length}/${this.game.inventory.slots})</span>`;\n    if (this.game.inventory.slots < this.game.config.inventory.maxSlots) {\n      const cost = this.game.inventoryManager.getUnlockCost();\n      html += `<button class=\"btn-unlock\" onclick=\"game.unlockSlot()\">ğŸ”“ æ‰©å…… (${cost}ğŸ’°)</button>`;\n    }\n    html += '</div><div class=\"inventory-grid\">';\n    this.game.inventory.items.forEach((item, idx) => {\n      const def = allItems.find(d => d.id === item.id);\n      if (!def) return;\n      html += `<div class=\"inv-item\" onclick=\"game.showItemDetail(${idx})\">\n        <span class=\"inv-icon\">${def.icon}</span>\n        <span class=\"inv-name\">${def.name}</span>\n        <span class=\"inv-count\">x${item.count}</span>\n      </div>`;\n    });\n    if (this.game.inventory.items.length === 0) {\n      html += '<p class=\"empty-inv\">èƒŒåŒ…ç©ºç©ºå¦‚ä¹Ÿ</p>';\n    }\n    html += '</div>';\n    const inventoryContent = $('inventoryContent');\n    if (inventoryContent) inventoryContent.innerHTML = html;\n  }\n\n  showItemDetail(index: number): void {\n    const item = this.game.inventory.items[index];\n    if (!item) return;\n    const allItems = [\n      ...this.game.config.items.consumables,\n      ...this.game.config.items.materials,\n      ...this.game.config.items.scrolls\n    ];\n    const def = allItems.find(d => d.id === item.id);\n    if (!def) return;\n    let html = `<div class=\"item-detail\">\n      <h3>${def.icon} ${def.name} x${item.count}</h3>`;\n    const consumableDef = def as ConsumableItem;\n    const scrollDef = def as ScrollItem;\n    if (consumableDef.heal) {\n      html += `<p>æ¢å¤ ${consumableDef.heal} HP</p>`;\n      if (!this.game.inBattle && this.game.player.hp < this.game.player.maxHP) {\n        html += `<button class=\"btn btn-use\" onclick=\"game.useItem(${index})\">ä½¿ç”¨</button>`;\n      } else if (this.game.inBattle) {\n        html += `<p class=\"hint\">æˆ˜æ–—ä¸­æ— æ³•ä½¿ç”¨</p>`;\n      } else {\n        html += `<p class=\"hint\">ç”Ÿå‘½å·²æ»¡</p>`;\n      }\n    } else if (scrollDef.skill) {\n      const skill = this.game.config.skills.find((s: Skill) => s.id === scrollDef.skill);\n      if (skill && this.game.player.learnedSkills.includes(scrollDef.skill)) {\n        html += `<p class=\"hint\">å·²å­¦ä¼š ${skill.name}</p>`;\n      } else if (skill) {\n        html += `<p>å­¦ä¹ æŠ€èƒ½ï¼š${skill.icon} ${skill.name}</p>`;\n        html += `<button class=\"btn btn-use\" onclick=\"game.learnScroll(${index})\">å­¦ä¹ </button>`;\n      }\n    } else {\n      html += `<p class=\"hint\">é”»é€ ææ–™</p>`;\n    }\n    html += '</div>';\n    const inventoryContent = $('inventoryContent');\n    if (inventoryContent) inventoryContent.innerHTML = html;\n  }\n\n  openItemMenu(): void {\n    if (!this.game.inBattle) return;\n    const consumables = this.game.inventory.items.filter(i => {\n      const def = this.game.config.items.consumables.find((d: ConsumableItem) => d.id === i.id);\n      return def && def.heal;\n    });\n    let html = '';\n    if (consumables.length === 0) {\n      html = '<p class=\"no-items\">æ²¡æœ‰å¯ä½¿ç”¨çš„é“å…·</p>';\n    } else {\n      html = '<div class=\"item-options\">';\n      consumables.forEach(item => {\n        const def = this.game.config.items.consumables.find((d: ConsumableItem) => d.id === item.id);\n        if (def) {\n          html += `<div class=\"item-option\" onclick=\"game.useItemInBattle('${item.id}')\">\n            <span class=\"item-icon\">${def.icon}</span>\n            <span class=\"item-name\">${def.name}</span>\n            <span class=\"item-count\">x${item.count}</span>\n            <span class=\"item-effect\">+${def.heal} HP</span>\n          </div>`;\n        }\n      });\n      html += '</div>';\n    }\n    const itemList = $('itemList');\n    const itemModal = $('itemModal');\n    if (itemList) itemList.innerHTML = html;\n    if (itemModal) itemModal.classList.add('show');\n  }\n\n  openSkillMenu(): void {\n    const learned = this.game.player.learnedSkills;\n    const selectedSkillId = this.game.player.selectedSkill || learned[0];\n    let html = '<div class=\"skill-select-list\">';\n    learned.forEach(skillId => {\n      const skill = this.game.config.skills.find((s: Skill) => s.id === skillId);\n      if (!skill) return;\n      const cd = this.game.player.skillCooldowns[skillId] || 0;\n      const isSelected = skillId === selectedSkillId;\n      html += `<div class=\"skill-select-item ${isSelected ? 'selected' : ''}\">\n        <span class=\"skill-info\">${skill.icon} ${skill.name}${cd > 0 ? ` (${cd})` : ''}</span>\n        <button class=\"btn-small ${isSelected ? 'btn-selected' : ''}\" onclick=\"game.selectSkill('${skillId}')\">${isSelected ? 'å·²é€‰' : 'é€‰æ‹©'}</button>\n      </div>`;\n    });\n    html += '</div>';\n    if (learned.length === 0) {\n      html = '<p style=\"color:#a0a0a0;text-align:center;\">è¿˜æ²¡æœ‰å­¦ä¼šæŠ€èƒ½</p>';\n    }\n    const skillMenuContent = $('skillMenuContent');\n    const skillModal = $('skillModal');\n    if (skillMenuContent) skillMenuContent.innerHTML = html;\n    if (skillModal) skillModal.classList.add('show');\n  }\n\n  openSkillManage(): void {\n    const skillModal = $('skillModal');\n    if (skillModal) skillModal.classList.remove('show');\n    const learned = this.game.player.learnedSkills;\n    const equipped = this.game.player.equippedSkills;\n    const unlocked = this.game.playerManager.getUnlockedSkillSlots();\n    let html = `<p class=\"slot-info\">å·²è§£é” ${unlocked} ä¸ªæŠ€èƒ½æ§½</p>`;\n    html += '<div class=\"skill-manage-grid\">';\n    for (let i = 0; i < 4; i++) {\n      const isUnlocked = i < unlocked;\n      const equippedId = equipped[i];\n      const skill = equippedId ? this.game.config.skills.find((s: Skill) => s.id === equippedId) : null;\n      html += `<div class=\"skill-slot ${isUnlocked ? '' : 'locked'}\">`;\n      if (isUnlocked) {\n        if (skill) {\n          html += `<span>${skill.icon} ${skill.name}</span>`;\n          html += `<button class=\"btn-small\" onclick=\"game.unequipSkill(${i})\">å¸ä¸‹</button>`;\n        } else {\n          html += `<span class=\"empty\">ç©ºæ§½ä½</span>`;\n        }\n      } else {\n        const unlockLevel = this.game.config.player.skillSlots[i];\n        html += `<span class=\"locked\">ğŸ”’ Lv${unlockLevel}è§£é”</span>`;\n      }\n      html += '</div>';\n    }\n    html += '</div>';\n    html += '<h4 style=\"margin: 12px 0 8px; color: var(--accent);\">å·²å­¦æŠ€èƒ½</h4><div class=\"learned-skills\">';\n    learned.forEach(skillId => {\n      if (equipped.includes(skillId)) return;\n      const skill = this.game.config.skills.find((s: Skill) => s.id === skillId);\n      if (!skill) return;\n      html += `<div class=\"skill-item\">\n        <span>${skill.icon} ${skill.name}</span>\n        <button class=\"btn-small\" onclick=\"game.equipSkill('${skillId}')\">è£…å¤‡</button>\n      </div>`;\n    });\n    html += '</div>';\n    const skillManageContent = $('skillManageContent');\n    const skillManageModal = $('skillManageModal');\n    if (skillManageContent) skillManageContent.innerHTML = html;\n    if (skillManageModal) skillManageModal.classList.add('show');\n  }\n\n  openForge(): void {\n    this.renderForgePanel();\n    const forgeModal = $('forgeModal');\n    if (forgeModal) forgeModal.classList.add('show');\n  }\n\n  renderForgePanel(): void {\n    let html = '<div class=\"forge-tabs\">';\n    html += '<button class=\"tab-btn active\" onclick=\"game.showForgeCategory(\\'weapons\\')\">âš”ï¸ æ­¦å™¨</button>';\n    html += '<button class=\"tab-btn\" onclick=\"game.showForgeCategory(\\'armors\\')\">ğŸ›¡ï¸ ç”²èƒ„</button>';\n    html += '</div>';\n    html += '<div id=\"forgeList\"></div>';\n    const forgeContent = $('forgeContent');\n    if (forgeContent) forgeContent.innerHTML = html;\n    this.showForgeCategory('weapons');\n  }\n\n  showForgeCategory(category: 'weapons' | 'armors'): void {\n    document.querySelectorAll('.forge-tabs .tab-btn').forEach((btn, idx) => {\n      btn.classList.toggle('active', (category === 'weapons' && idx === 0) || (category === 'armors' && idx === 1));\n    });\n    const items = this.game.config.equipment[category];\n    const currentEquip = category === 'weapons' ? this.game.player.weapon : this.game.player.armor;\n    let html = '<div class=\"forge-list\">';\n    items.forEach((item: Weapon | Armor) => {\n      const isEquipped = currentEquip === item.id;\n      const canForge = this.game.inventoryManager.canForge(item);\n      html += `<div class=\"forge-item ${isEquipped ? 'equipped' : ''}\">`;\n      html += `<div class=\"forge-info\">\n        <span class=\"forge-icon\">${item.icon}</span>\n        <span class=\"forge-name\">${item.name}</span>\n        <span class=\"forge-stat\">${category === 'weapons' ? `ATK+${(item as Weapon).atk}` : `DEF+${(item as Armor).def}`}</span>\n        ${isEquipped ? '<span class=\"equipped-badge\">å·²è£…å¤‡</span>' : ''}\n      </div>`;\n      html += '<div class=\"forge-mats\">';\n      Object.entries(item.materials).forEach(([matId, count]) => {\n        const mat = this.game.config.items.materials.find(m => m.id === matId);\n        const have = this.game.inventoryManager.getItemCount(matId);\n        const enough = have >= count;\n        html += `<span class=\"mat ${enough ? '' : 'lack'}\">${mat ? mat.icon : '?'} ${have}/${count}</span>`;\n      });\n      html += '</div>';\n      if (isEquipped) {\n        html += `<button class=\"btn btn-unequip\" onclick=\"game.unequipItem('${category}')\">å¸ä¸‹</button>`;\n      } else if (canForge) {\n        html += `<button class=\"btn btn-forge\" onclick=\"game.forgeItem('${category}', '${item.id}')\">é”»é€ </button>`;\n      } else {\n        html += `<button class=\"btn btn-forge disabled\" disabled>ææ–™ä¸è¶³</button>`;\n      }\n      html += '</div>';\n    });\n    html += '</div>';\n    const forgeList = $('forgeList');\n    if (forgeList) forgeList.innerHTML = html;\n  }\n\n  showConfirm(message: string, onConfirm: () => void): void {\n    const confirmMessage = $('confirmMessage');\n    const confirmBtn = $<HTMLButtonElement>('confirmBtn');\n    const confirmModal = $('confirmModal');\n    if (confirmMessage) confirmMessage.textContent = message;\n    if (confirmBtn) {\n      confirmBtn.onclick = () => {\n        this.closeConfirm();\n        onConfirm();\n      };\n    }\n    if (confirmModal) confirmModal.classList.add('show');\n  }\n\n  closeConfirm(): void {\n    const confirmModal = $('confirmModal');\n    if (confirmModal) confirmModal.classList.remove('show');\n  }\n\n  openSettings(): void {\n    const settingsModal = $('settingsModal');\n    if (settingsModal) settingsModal.classList.add('show');\n  }\n\n  closeAllModals(): void {\n    document.querySelectorAll('.modal').forEach(m => m.classList.remove('show'));\n  }\n\n  updateBattleBackground(floor: number): void {\n    const lore = this.game.storyManager.getWorldLore(floor);\n    const battleArea = document.querySelector('.battle-area');\n    if (battleArea && lore) {\n      (battleArea as HTMLElement).className = `battle-area ${lore.bgClass}`;\n    }\n  }\n\n  showLoreModal(lore: WorldLore, floor: number): void {\n    const loreIcon = $('loreIcon');\n    const loreTitle = $('loreTitle');\n    const loreDescription = $('loreDescription');\n    const loreContent = $('loreContent');\n    const storyModal = $('storyModal');\n\n    if (loreIcon) loreIcon.textContent = lore.icon;\n    if (loreTitle) loreTitle.textContent = `${lore.name} - ç¬¬${floor}å±‚`;\n    if (loreDescription) loreDescription.textContent = lore.description;\n    if (loreContent) loreContent.textContent = lore.lore;\n    if (storyModal) storyModal.classList.add('show');\n  }\n\n  closeStoryModal(): void {\n    const storyModal = $('storyModal');\n    if (storyModal) storyModal.classList.remove('show');\n  }\n\n  showNPCModal(npc: NPC): void {\n    const npcAvatar = $('npcAvatar');\n    const npcName = $('npcName');\n    const npcGreeting = $('npcGreeting');\n    const npcDialogue = $('npcDialogue');\n    const npcActions = $('npcActions');\n    const npcModal = $('npcModal');\n\n    if (npcAvatar) npcAvatar.textContent = npc.avatar;\n    if (npcName) npcName.textContent = npc.name;\n    if (npcGreeting) npcGreeting.textContent = npc.greeting;\n\n    const dialogue = this.game.storyManager.getNPCDialogue(npc);\n    if (npcDialogue) npcDialogue.textContent = dialogue;\n\n    let actionsHtml = '';\n    if (npc.shop && npc.shop.length > 0) {\n      actionsHtml = '<div class=\"npc-shop\">';\n      npc.shop.forEach(item => {\n        const itemDef =\n          this.game.config.items.consumables.find((i: ConsumableItem) => i.id === item.itemId) ||\n          this.game.config.items.scrolls.find((i: ScrollItem) => i.id === item.itemId);\n        if (itemDef) {\n          const canBuy = this.game.player.gold >= item.price;\n          actionsHtml += `<div class=\"shop-item ${canBuy ? '' : 'disabled'}\" onclick=\"${canBuy ? `game.buyNPCItem('${npc.id}', '${item.itemId}')` : ''}\">\n            <span>${itemDef.icon} ${itemDef.name}</span>\n            <span>${item.price}ğŸ’°</span>\n          </div>`;\n        }\n      });\n      actionsHtml += '</div>';\n    }\n\n    if (npc.reward) {\n      actionsHtml += `<button class=\"btn btn-primary\" onclick=\"game.acceptNPCReward('${npc.id}')\">æ¥å—å¸®åŠ©</button>`;\n    }\n\n    actionsHtml += `<button class=\"btn btn-secondary\" onclick=\"game.closeNPCModal()\">ç¦»å¼€</button>`;\n    if (npcActions) npcActions.innerHTML = actionsHtml;\n    if (npcModal) npcModal.classList.add('show');\n  }\n\n  closeNPCModal(): void {\n    const npcModal = $('npcModal');\n    if (npcModal) npcModal.classList.remove('show');\n  }\n\n  showEventModal(event: RandomEvent, result: RewardResult): void {\n    const eventIcon = $('eventIcon');\n    const eventName = $('eventName');\n    const eventDescription = $('eventDescription');\n    const eventResult = $('eventResult');\n    const eventModal = $('eventModal');\n\n    if (eventIcon) eventIcon.textContent = event.icon;\n    if (eventName) eventName.textContent = event.name;\n    if (eventDescription) eventDescription.textContent = event.description;\n\n    let resultHtml = '';\n    if (result.lore) {\n      resultHtml += `<p class=\"event-lore\">${result.lore}</p>`;\n    }\n    if (result.gold > 0) {\n      resultHtml += `<p>ğŸ’° è·å¾— ${result.gold} é‡‘å¸</p>`;\n    }\n    if (result.exp > 0) {\n      resultHtml += `<p>â­ è·å¾— ${result.exp} ç»éªŒ</p>`;\n    }\n    if (result.heal > 0) {\n      resultHtml += `<p>ğŸ’š æ¢å¤ ${result.heal} ç”Ÿå‘½</p>`;\n    }\n    if (result.items && result.items.length > 0) {\n      result.items.forEach(item => {\n        const itemDef =\n          this.game.config.items.consumables.find((i: ConsumableItem) => i.id === item.itemId) ||\n          this.game.config.items.scrolls.find((i: ScrollItem) => i.id === item.itemId);\n        if (itemDef) {\n          resultHtml += `<p>ğŸ è·å¾— ${itemDef.icon} ${itemDef.name}</p>`;\n        }\n      });\n    }\n    if (eventResult) eventResult.innerHTML = resultHtml;\n    if (eventModal) eventModal.classList.add('show');\n  }\n\n  closeEventModal(): void {\n    const eventModal = $('eventModal');\n    if (eventModal) eventModal.classList.remove('show');\n  }\n}\n","import { $ } from './utils/dom';\nimport type { GameConfig, Player, Inventory, MonsterInstance, SaveData, NPC } from './types';\nimport { PlayerManager } from './managers/PlayerManager';\nimport { InventoryManager } from './managers/InventoryManager';\nimport { StoryManager } from './managers/StoryManager';\nimport { BattleManager } from './managers/BattleManager';\nimport { UIManager } from './managers/UIManager';\n\nexport class Game {\n  config: GameConfig;\n  floor: number = 1;\n  killed: number = 0;\n  monster: MonsterInstance | null = null;\n  inBattle: boolean = false;\n  slowEffect: number = 0;\n  canAdvanceFloor: boolean = false;\n  player!: Player;\n  inventory!: Inventory;\n\n  ui: UIManager;\n  battle: BattleManager;\n  playerManager: PlayerManager;\n  inventoryManager: InventoryManager;\n  storyManager: StoryManager;\n\n  constructor(config: GameConfig) {\n    this.config = config;\n    this.ui = new UIManager(this);\n    this.battle = new BattleManager(this);\n    this.playerManager = new PlayerManager(this);\n    this.inventoryManager = new InventoryManager(this);\n    this.storyManager = new StoryManager(this);\n  }\n\n  init(): void {\n    this.load();\n    this.bindEvents();\n    this.ui.updateSkillName();\n    this.ui.render();\n    setTimeout(() => this.explore(), 300);\n  }\n\n  save(): void {\n    const data: SaveData = {\n      player: this.player,\n      floor: this.floor,\n      killed: this.killed,\n      inventory: this.inventory,\n      story: this.storyManager.save()\n    };\n    localStorage.setItem('loopingEveSave', JSON.stringify(data));\n  }\n\n  load(): void {\n    const saved = localStorage.getItem('loopingEveSave');\n    if (saved) {\n      const data: SaveData = JSON.parse(saved);\n      this.player = data.player;\n      this.floor = data.floor;\n      this.killed = data.killed;\n      this.inventory = data.inventory || { slots: this.config.inventory.initialSlots, items: [] };\n      this.playerManager.migrateOldData();\n      this.storyManager.load(data.story);\n      this.canAdvanceFloor = this.killed >= this.getMonstersToAdvance();\n    } else {\n      this.playerManager.init();\n      this.inventoryManager.init();\n    }\n  }\n\n  bindEvents(): void {\n    const btnAttack = $('btnAttack');\n    const btnSkill = $('btnSkill');\n    const btnItem = $('btnItem');\n    const btnNextFloor = $('btnNextFloor');\n    const btnSettings = $('btnSettings');\n    const btnClear2 = $('btnClear2');\n\n    if (btnAttack) btnAttack.onclick = () => this.battle.attack();\n    if (btnSkill) btnSkill.onclick = () => this.battle.useSelectedSkill();\n    if (btnItem) btnItem.onclick = () => this.inventoryManager.smartUseItem();\n    if (btnNextFloor) btnNextFloor.onclick = () => this.nextFloor();\n    if (btnSettings) btnSettings.onclick = () => this.ui.openSettings();\n    if (btnClear2)\n      btnClear2.onclick = () => {\n        const settingsModal = $('settingsModal');\n        if (settingsModal) settingsModal.classList.remove('show');\n        this.ui.showConfirm('ç¡®å®šè¦é‡ç½®æ¸¸æˆå—ï¼Ÿæ‰€æœ‰è¿›åº¦å°†ä¸¢å¤±ï¼', () => this.clearSave());\n      };\n  }\n\n  clearSave(): void {\n    localStorage.removeItem('loopingEveSave');\n    this.playerManager.init();\n    this.inventoryManager.init();\n    this.storyManager.reset();\n    this.floor = 1;\n    this.killed = 0;\n    this.monster = null;\n    this.inBattle = false;\n    this.slowEffect = 0;\n    this.canAdvanceFloor = false;\n    const battleLog = $('battleLog');\n    if (battleLog) battleLog.innerHTML = '<p>å­˜æ¡£å·²æ¸…é™¤ï¼Œç‚¹å‡»ã€Œæ¢ç´¢ã€å¼€å§‹ï¼</p>';\n    this.ui.setButtons({ attack: true, skill: true, item: true, inventory: false, next: true });\n    this.ui.updateBattleBackground(1);\n    this.ui.render();\n    this.ui.closeAllModals();\n  }\n\n  nextFloor(): void {\n    const oldFloor = this.floor;\n    this.floor++;\n    this.killed = 0;\n    this.ui.log(`ğŸ“ è¿›å…¥ç¬¬ ${this.floor} å±‚ï¼`);\n    const btnNextFloor = $<HTMLButtonElement>('btnNextFloor');\n    if (btnNextFloor) btnNextFloor.disabled = true;\n\n    this.ui.updateBattleBackground(this.floor);\n\n    const loreEvent = this.storyManager.onFloorAdvance(this.floor, oldFloor);\n    if (loreEvent) {\n      this.ui.showLoreModal(loreEvent.data, this.floor);\n    }\n\n    const npcEvent = this.storyManager.checkNPC(this.floor);\n    if (npcEvent) {\n      setTimeout(() => {\n        this.ui.showNPCModal(npcEvent.data);\n      }, loreEvent ? 2000 : 500);\n    }\n\n    this.save();\n    this.ui.render();\n  }\n\n  getMonstersToAdvance(): number {\n    const base = this.config.floor.monstersToAdvance;\n    const max = this.config.floor.maxMonsters || 10;\n    const floor = this.floor;\n    if (floor <= 5) return base;\n    if (floor <= 10) return Math.min(base + 1, max);\n    if (floor <= 20) return Math.min(base + 2, max);\n    return Math.min(base + 3, max);\n  }\n\n  handleAutoNext(): void {\n    const autoNextEl = $('autoNext') as HTMLInputElement;\n    const autoNext = autoNextEl?.checked ?? false;\n    setTimeout(() => {\n      if (this.canAdvanceFloor && autoNext) {\n        this.nextFloor();\n        setTimeout(() => this.battle.explore(), 300);\n      } else {\n        this.battle.explore();\n      }\n    }, 500);\n  }\n\n  gameOver(): void {\n    localStorage.removeItem('loopingEveSave');\n    const finalFloor = $('finalFloor');\n    const finalLevel = $('finalLevel');\n    const finalGold = $('finalGold');\n    const gameOverModal = $('gameOverModal');\n    if (finalFloor) finalFloor.textContent = String(this.floor);\n    if (finalLevel) finalLevel.textContent = String(this.player.level);\n    if (finalGold) finalGold.textContent = String(this.player.gold);\n    if (gameOverModal) gameOverModal.classList.add('show');\n  }\n\n  restart(): void {\n    this.playerManager.init();\n    this.inventoryManager.init();\n    this.storyManager.reset();\n    this.floor = 1;\n    this.killed = 0;\n    this.monster = null;\n    this.inBattle = false;\n    this.slowEffect = 0;\n    localStorage.removeItem('loopingEveSave');\n    const gameOverModal = $('gameOverModal');\n    const battleLog = $('battleLog');\n    if (gameOverModal) gameOverModal.classList.remove('show');\n    if (battleLog) battleLog.innerHTML = '<p>æ¸¸æˆå¼€å§‹ï¼</p>';\n    this.ui.setButtons({ attack: true, skill: true, item: true, inventory: false, next: true });\n    this.ui.updateBattleBackground(1);\n    this.ui.render();\n    setTimeout(() => this.explore(), 500);\n  }\n\n  explore(): void {\n    this.battle.explore();\n  }\n  attack(): void {\n    this.battle.attack();\n  }\n  useSkill(id: string): void {\n    this.battle.useSkill(id);\n  }\n  useFirstSkill(): void {\n    this.battle.useSelectedSkill();\n  }\n  useItem(idx: number): void {\n    this.inventoryManager.useItem(idx);\n  }\n  useItemInBattle(id: string): void {\n    this.inventoryManager.useItemInBattle(id);\n  }\n  smartUseItem(): void {\n    this.inventoryManager.smartUseItem();\n  }\n  learnScroll(idx: number): void {\n    this.inventoryManager.learnScroll(idx);\n  }\n  unlockSlot(): void {\n    this.inventoryManager.unlockSlot();\n  }\n  openInventory(): void {\n    this.ui.openInventory();\n  }\n  openItemMenu(): void {\n    this.ui.openItemMenu();\n  }\n  openSkillMenu(): void {\n    this.ui.openSkillMenu();\n  }\n  openSkillManage(): void {\n    this.ui.openSkillManage();\n  }\n  openForge(): void {\n    this.ui.openForge();\n  }\n  showForgeCategory(cat: 'weapons' | 'armors'): void {\n    this.ui.showForgeCategory(cat);\n  }\n  forgeItem(cat: 'weapons' | 'armors', id: string): void {\n    this.inventoryManager.forgeItem(cat, id);\n  }\n  unequipItem(cat: 'weapons' | 'armors'): void {\n    this.playerManager.unequipItem(cat);\n    this.save();\n    this.ui.render();\n    this.ui.showForgeCategory(cat);\n    this.ui.log('ğŸ“¤ å·²å¸ä¸‹è£…å¤‡');\n  }\n  equipSkill(id: string): void {\n    const replaced = this.playerManager.equipSkill(id);\n    const skill = this.config.skills.find(s => s.id === id);\n    if (replaced && skill) this.ui.log(`âš ï¸ ${replaced} å·²è¢«æ›¿æ¢ä¸º ${skill.name}`);\n    this.save();\n    this.ui.updateSkillName();\n    this.ui.openSkillManage();\n  }\n  unequipSkill(idx: number): void {\n    this.playerManager.unequipSkill(idx);\n    this.save();\n    this.ui.updateSkillName();\n    this.ui.openSkillManage();\n  }\n  selectSkill(id: string): void {\n    this.player.selectedSkill = id;\n    this.save();\n    this.ui.updateSkillName();\n    this.ui.openSkillMenu();\n  }\n  closeLevelUpModal(): void {\n    this.ui.closeLevelUpModal();\n  }\n  closeStoryModal(): void {\n    this.ui.closeStoryModal();\n  }\n  closeNPCModal(): void {\n    this.ui.closeNPCModal();\n  }\n  closeEventModal(): void {\n    this.ui.closeEventModal();\n  }\n  buyNPCItem(npcId: string, itemId: string): void {\n    const npc = this.config.npcs.find((n: NPC) => n.id === npcId);\n    if (!npc || !npc.shop) return;\n    const shopItem = npc.shop.find(s => s.itemId === itemId);\n    if (!shopItem) return;\n    if (this.player.gold < shopItem.price) {\n      this.ui.log('ğŸ’° é‡‘å¸ä¸è¶³ï¼');\n      return;\n    }\n    this.player.gold -= shopItem.price;\n    this.inventoryManager.addItem(itemId, 1);\n    this.ui.log(`ğŸ’° è´­ä¹°äº†ç‰©å“ï¼`);\n    this.save();\n    this.ui.render();\n  }\n  acceptNPCReward(npcId: string): void {\n    const npc = this.config.npcs.find((n: NPC) => n.id === npcId);\n    if (!npc) return;\n    const result = this.storyManager.processNPCReward(npc);\n    this.storyManager.applyReward(result);\n    this.ui.closeNPCModal();\n    if (result.gold > 0) this.ui.log(`ğŸ’° è·å¾— ${result.gold} é‡‘å¸`);\n    if (result.exp > 0) this.ui.log(`â­ è·å¾— ${result.exp} ç»éªŒ`);\n    if (result.items.length > 0) this.ui.log(`ğŸ è·å¾—ç‰©å“`);\n    this.save();\n    this.ui.render();\n  }\n  showConfirm(msg: string, cb: () => void): void {\n    this.ui.showConfirm(msg, cb);\n  }\n  closeConfirm(): void {\n    this.ui.closeConfirm();\n  }\n  showItemDetail(idx: number): void {\n    this.ui.showItemDetail(idx);\n  }\n}\n\ndeclare global {\n  interface Window {\n    game: Game;\n  }\n}\n","import './style.css';\nimport type { GameConfig } from './types';\nimport { Game } from './Game';\n\nasync function loadConfig(): Promise<GameConfig> {\n  const basePath = import.meta.env.PROD ? './MainGame/dist/' : './';\n  const res = await fetch(basePath + 'Configs/config.json?t=' + Date.now());\n  if (!res.ok) throw new Error('é…ç½®åŠ è½½å¤±è´¥');\n  return res.json();\n}\n\nfunction setupModals(game: Game): void {\n  document.querySelectorAll('.modal').forEach(modal => {\n    modal.addEventListener('click', e => {\n      if (e.target === modal) {\n        if (modal.id === 'gameOverModal') {\n          game.restart();\n        } else {\n          modal.classList.remove('show');\n        }\n      }\n    });\n  });\n}\n\nloadConfig()\n  .then(config => {\n    const game = new Game(config);\n    window.game = game;\n    game.init();\n    setupModals(game);\n  })\n  .catch(e => {\n    alert('é…ç½®åŠ è½½å¤±è´¥ï¼š' + e.message);\n  });\n"],"names":["$","id","PlayerManager","game","atk","weapon","w","def","armor","a","level","lvl","cfg","skillId","equipped","unlocked","replacedSkill","oldSkill","s","index","skill","levelMatch","slots","key","category","InventoryManager","itemId","count","itemDef","i","existing","newCount","added","idx","item","monsterId","lootTable","loot","d","healAmt","missingHP","hpPercent","consumables","b","selectedItem","cost","matId","StoryManager","floor","loreList","lore","newFloor","_oldFloor","loreKey","availableNPCs","npc","availableEvents","event","eventKey","reward","outcomes","effects","result","totalWeight","sum","o","random","outcome","e","effect","actualHeal","data","BattleManager","monsters","m","mult","rand","dmg","msg","cd","playerCritRate","monsterDodgeRate","isCritical","finalDmg","critText","playerDodgeRate","monsterCritRate","randomEvent","UIManager","log","p","firstChild","sel","el","value","isHeal","isDodge","popup","className","monsterCard","rect","playerLevel","playerHP","playerMaxHP","playerATK","playerDEF","playerEXP","playerMaxEXP","playerGold","currentFloor","hpFill","expBar","expPercent","target","displayKilled","progressEl","weaponEl","armorEl","we","ar","monsterAvatar","monsterName","monsterHP","monsterMaxHP","monsterHPFill","attack","next","btnAttack","btnSkill","btnItem","btnNextFloor","shouldDisableNext","btn","currentSkillName","newLevel","levelUpHP","levelUpATK","levelUpDEF","levelUpModal","inventoryModal","allItems","html","inventoryContent","consumableDef","scrollDef","itemList","itemModal","learned","selectedSkillId","isSelected","skillMenuContent","skillModal","isUnlocked","equippedId","unlockLevel","skillManageContent","skillManageModal","forgeModal","forgeContent","items","currentEquip","isEquipped","canForge","mat","have","enough","forgeList","message","onConfirm","confirmMessage","confirmBtn","confirmModal","settingsModal","battleArea","loreIcon","loreTitle","loreDescription","loreContent","storyModal","npcAvatar","npcName","npcGreeting","npcDialogue","npcActions","npcModal","dialogue","actionsHtml","canBuy","eventIcon","eventName","eventDescription","eventResult","eventModal","resultHtml","Game","config","saved","btnSettings","btnClear2","battleLog","oldFloor","loreEvent","npcEvent","base","max","autoNext","finalFloor","finalLevel","finalGold","gameOverModal","cat","replaced","npcId","n","shopItem","cb","loadConfig","res","setupModals","modal"],"mappings":"ssBAAO,MAAMA,EAA0CC,GAAyB,SAAS,eAAeA,CAAE,ECGnG,MAAMC,CAAc,CACjB,KAER,YAAYC,EAAY,CACtB,KAAK,KAAOA,CACd,CAEA,MAAa,CACX,KAAK,KAAK,OAAS,CACjB,GAAG,KAAK,KAAK,OAAO,OAAO,QAC3B,OAAQ,KACR,MAAO,KACP,cAAe,CAAC,aAAa,EAC7B,eAAgB,CAAC,aAAa,EAC9B,cAAe,cACf,eAAgB,CAAA,CAAC,CAErB,CAEA,aAAsB,CACpB,IAAIC,EAAM,KAAK,KAAK,OAAO,IAC3B,GAAI,KAAK,KAAK,OAAO,OAAQ,CAC3B,MAAMC,EAAS,KAAK,KAAK,OAAO,UAAU,QAAQ,KAAKC,GAAKA,EAAE,KAAO,KAAK,KAAK,OAAO,MAAM,EACxFD,OAAeA,EAAO,IAC5B,CACA,OAAOD,CACT,CAEA,aAAsB,CACpB,IAAIG,EAAM,KAAK,KAAK,OAAO,IAC3B,GAAI,KAAK,KAAK,OAAO,MAAO,CAC1B,MAAMC,EAAQ,KAAK,KAAK,OAAO,UAAU,OAAO,KAAKC,GAAKA,EAAE,KAAO,KAAK,KAAK,OAAO,KAAK,EACrFD,OAAcA,EAAM,IAC1B,CACA,OAAOD,CACT,CAEA,uBAAgC,CAC9B,MAAMG,EAAQ,KAAK,KAAK,OAAO,MAC/B,OAAO,KAAK,KAAK,OAAO,OAAO,WAAW,OAAOC,GAAOD,GAASC,CAAG,EAAE,MACxE,CAEA,SAAgB,CACd,MAAMC,EAAM,KAAK,KAAK,OAAO,OAAO,QACpC,KAAO,KAAK,KAAK,OAAO,KAAO,KAAK,KAAK,OAAO,QAC9C,KAAK,KAAK,OAAO,KAAO,KAAK,KAAK,OAAO,OACzC,KAAK,KAAK,OAAO,QACjB,KAAK,KAAK,OAAO,OAASA,EAAI,GAC9B,KAAK,KAAK,OAAO,GAAK,KAAK,IAAI,KAAK,KAAK,OAAO,GAAKA,EAAI,GAAI,KAAK,KAAK,OAAO,KAAK,EACnF,KAAK,KAAK,OAAO,KAAOA,EAAI,IAC5B,KAAK,KAAK,OAAO,KAAOA,EAAI,IAC5B,KAAK,KAAK,OAAO,OAAS,KAAK,MAAM,KAAK,KAAK,OAAO,OAASA,EAAI,aAAa,EAChF,KAAK,KAAK,GAAG,YAAY,KAAK,KAAK,OAAO,MAAOA,CAAG,CAExD,CAEA,WAAWC,EAAgC,CACzC,MAAMC,EAAW,KAAK,KAAK,OAAO,eAClC,GAAIA,EAAS,SAASD,CAAO,EAAG,OAAO,KACvC,MAAME,EAAW,KAAK,sBAAA,EACtB,IAAIC,EAA+B,KACnC,GAAIF,EAAS,QAAUC,GACjBD,EAAS,CAAC,EAAG,CACf,MAAMG,EAAW,KAAK,KAAK,OAAO,OAAO,KAAKC,GAAKA,EAAE,KAAOJ,EAAS,CAAC,CAAC,EACvEE,EAAgBC,EAAWA,EAAS,KAAOH,EAAS,CAAC,EACrDA,EAAS,MAAA,CACX,CAEF,OAAAA,EAAS,KAAKD,CAAO,EACdG,CACT,CAEA,aAAaG,EAAwB,CACnC,OAAIA,EAAQ,GAAKA,GAAS,KAAK,KAAK,OAAO,eAAe,OAAe,IACzE,KAAK,KAAK,OAAO,eAAe,OAAOA,EAAO,CAAC,EACxC,GACT,CAEA,kBAAyB,CACvB,MAAMT,EAAQ,KAAK,KAAK,OAAO,MAC/B,KAAK,KAAK,OAAO,OAAO,QAASU,GAAiB,CAEhD,GADI,KAAK,KAAK,OAAO,cAAc,SAASA,EAAM,EAAE,GAChDA,EAAM,SAAW,WAAaA,EAAM,SAAW,SAAU,OAC7D,MAAMC,EAAaD,EAAM,OAAO,MAAM,cAAc,EACpD,GAAIC,GAAcX,GAAS,SAASW,EAAW,CAAC,CAAC,IAC/C,KAAK,KAAK,OAAO,cAAc,KAAKD,EAAM,EAAE,EAC5C,KAAK,KAAK,GAAG,IAAI,WAAWA,EAAM,IAAI,IAAIA,EAAM,IAAI,GAAG,EACnD,CAAC,KAAK,KAAK,OAAO,eAAe,SAASA,EAAM,EAAE,GAAG,CACvD,MAAME,EAAQ,KAAK,sBAAA,EACf,KAAK,KAAK,OAAO,eAAe,OAASA,GAC3C,KAAK,KAAK,OAAO,eAAe,KAAKF,EAAM,EAAE,CAEjD,CAEJ,CAAC,CACH,CAEA,iBAAwB,CACtB,OAAO,KAAK,KAAK,KAAK,OAAO,cAAc,EAAE,QAASG,GAAgB,CAChE,KAAK,KAAK,OAAO,eAAeA,CAAG,EAAI,GACzC,KAAK,KAAK,OAAO,eAAeA,CAAG,GAEvC,CAAC,EACD,KAAK,KAAK,GAAG,gBAAA,CACf,CAEA,gBAAuB,CAChB,KAAK,KAAK,OAAO,gBACpB,KAAK,KAAK,OAAO,cAAgB,CAAC,aAAa,EAC/C,KAAK,KAAK,OAAO,eAAiB,CAAC,aAAa,EAChD,KAAK,KAAK,OAAO,eAAiB,CAAA,GAE/B,KAAK,KAAK,OAAO,gBACpB,KAAK,KAAK,OAAO,cAAgB,KAAK,KAAK,OAAO,cAAc,CAAC,GAAK,eAEnE,KAAK,KAAK,OAAO,SAAQ,KAAK,KAAK,OAAO,OAAS,MACnD,KAAK,KAAK,OAAO,QAAO,KAAK,KAAK,OAAO,MAAQ,KACxD,CAEA,YAAYC,EAAsC,CAC5CA,IAAa,UACf,KAAK,KAAK,OAAO,OAAS,KAE1B,KAAK,KAAK,OAAO,MAAQ,IAE7B,CACF,CC9HO,MAAMC,CAAiB,CACpB,KAER,YAAYtB,EAAY,CACtB,KAAK,KAAOA,CACd,CAEA,MAAa,CACX,KAAK,KAAK,UAAY,CACpB,MAAO,KAAK,KAAK,OAAO,UAAU,aAClC,MAAO,CAAA,CAAC,CAEZ,CAEA,QAAQuB,EAAgBC,EAAgB,EAAS,CAM/C,MAAMC,EALW,CACf,GAAG,KAAK,KAAK,OAAO,MAAM,YAC1B,GAAG,KAAK,KAAK,OAAO,MAAM,UAC1B,GAAG,KAAK,KAAK,OAAO,MAAM,OAAA,EAEH,KAAKC,GAAKA,EAAE,KAAOH,CAAM,EAClD,GAAI,CAACE,EAAS,OACd,MAAME,EAAW,KAAK,KAAK,UAAU,MAAM,KAAKD,GAAKA,EAAE,KAAOH,CAAM,EACpE,GAAII,EAAU,CACZ,MAAMC,EAAW,KAAK,IAAID,EAAS,MAAQH,EAAOC,EAAQ,QAAQ,EAC5DI,EAAQD,EAAWD,EAAS,MAClCA,EAAS,MAAQC,EACbC,EAAQ,GACV,KAAK,KAAK,GAAG,IAAI,MAAMJ,EAAQ,IAAI,IAAIA,EAAQ,IAAI,KAAKI,CAAK,EAAE,CAEnE,KAAO,CACL,GAAI,KAAK,KAAK,UAAU,MAAM,QAAU,KAAK,KAAK,UAAU,MAAO,CACjE,KAAK,KAAK,GAAG,IAAI,WAAWJ,EAAQ,IAAI,MAAM,EAC9C,MACF,CACA,KAAK,KAAK,UAAU,MAAM,KAAK,CAAE,GAAIF,EAAQ,MAAO,KAAK,IAAIC,EAAOC,EAAQ,QAAQ,EAAG,EACvF,KAAK,KAAK,GAAG,IAAI,MAAMA,EAAQ,IAAI,IAAIA,EAAQ,IAAI,KAAKD,CAAK,EAAE,CACjE,CACF,CAEA,WAAWD,EAAgBC,EAAgB,EAAY,CACrD,MAAMM,EAAM,KAAK,KAAK,UAAU,MAAM,UAAU,GAAK,EAAE,KAAOP,CAAM,EACpE,OAAIO,IAAQ,GAAW,IACvB,KAAK,KAAK,UAAU,MAAMA,CAAG,EAAE,OAASN,EACpC,KAAK,KAAK,UAAU,MAAMM,CAAG,EAAE,OAAS,GAC1C,KAAK,KAAK,UAAU,MAAM,OAAOA,EAAK,CAAC,EAElC,GACT,CAEA,aAAaP,EAAwB,CACnC,MAAMQ,EAAO,KAAK,KAAK,UAAU,MAAM,KAAKL,GAAKA,EAAE,KAAOH,CAAM,EAChE,OAAOQ,EAAOA,EAAK,MAAQ,CAC7B,CAEA,UAAUC,EAAyB,CACjC,MAAMC,EAAY,KAAK,KAAK,OAAO,UAAUD,CAAS,EACjDC,GACLA,EAAU,QAAQC,GAAQ,CACxB,GAAI,KAAK,SAAWA,EAAK,KAAM,CAC7B,MAAMV,EAAQ,KAAK,MAAM,KAAK,OAAA,GAAYU,EAAK,SAAWA,EAAK,SAAW,EAAE,EAAIA,EAAK,SACrF,KAAK,QAAQA,EAAK,OAAQV,CAAK,CACjC,CACF,CAAC,CACH,CAEA,QAAQR,EAAqB,CAC3B,MAAMe,EAAO,KAAK,KAAK,UAAU,MAAMf,CAAK,EAC5C,GAAI,CAACe,EAAM,OACX,MAAM3B,EAAM,KAAK,KAAK,OAAO,MAAM,YAAY,KAAM+B,GAAsBA,EAAE,KAAOJ,EAAK,EAAE,EAC3F,GAAI,CAAC3B,GAAO,CAACA,EAAI,KAAM,OACvB,MAAMgC,EAAU,KAAK,IAAIhC,EAAI,KAAM,KAAK,KAAK,OAAO,MAAQ,KAAK,KAAK,OAAO,EAAE,EAC3EgC,GAAW,IACf,KAAK,KAAK,OAAO,IAAMA,EACvB,KAAK,WAAWL,EAAK,GAAI,CAAC,EAC1B,KAAK,KAAK,GAAG,IAAI,SAAS3B,EAAI,IAAI,0BAA0BgC,CAAO,YAAY,EAC/E,KAAK,KAAK,KAAA,EACV,KAAK,KAAK,GAAG,OAAA,EACb,KAAK,KAAK,GAAG,qBAAA,EACf,CAEA,gBAAgBb,EAAsB,CACpC,GAAI,CAAC,KAAK,KAAK,SAAU,OACzB,MAAMnB,EAAM,KAAK,KAAK,OAAO,MAAM,YAAY,KAAM+B,GAAsBA,EAAE,KAAOZ,CAAM,EAC1F,GAAI,CAACnB,GAAO,CAACA,EAAI,KAAM,OACvB,MAAMgC,EAAU,KAAK,IAAIhC,EAAI,KAAM,KAAK,KAAK,OAAO,MAAQ,KAAK,KAAK,OAAO,EAAE,EAC/E,KAAK,KAAK,OAAO,IAAMgC,EACvB,KAAK,WAAWb,EAAQ,CAAC,EACzB,KAAK,KAAK,GAAG,IAAI,SAASnB,EAAI,IAAI,0BAA0BgC,CAAO,YAAY,EAC/E,KAAK,KAAK,GAAG,gBAAgBA,EAAS,EAAI,EAC1C,SAAS,eAAe,WAAW,GAAG,UAAU,OAAO,MAAM,EAC7D,KAAK,KAAK,KAAA,EACV,KAAK,KAAK,GAAG,OAAA,EACb,KAAK,KAAK,OAAO,YAAA,CACnB,CAEA,cAAqB,CACnB,GAAI,CAAC,KAAK,KAAK,SAAU,CACvB,KAAK,KAAK,GAAG,IAAI,UAAU,EAC3B,MACF,CACA,MAAMC,EAAY,KAAK,KAAK,OAAO,MAAQ,KAAK,KAAK,OAAO,GAC5D,GAAIA,EAAY,EAAG,CACjB,KAAK,KAAK,GAAG,IAAI,YAAY,EAC7B,MACF,CACA,MAAMC,EAAY,KAAK,KAAK,OAAO,GAAK,KAAK,KAAK,OAAO,MACnDC,EAAc,KAAK,KAAK,UAAU,MACrC,OAAOb,GAAK,CACX,MAAMtB,EAAM,KAAK,KAAK,OAAO,MAAM,YAAY,KAAM+B,GAAsBA,EAAE,KAAOT,EAAE,EAAE,EACxF,OAAOtB,GAAOA,EAAI,IACpB,CAAC,EACA,IAAIsB,GAAK,CACR,MAAMtB,EAAM,KAAK,KAAK,OAAO,MAAM,YAAY,KAAM+B,GAAsBA,EAAE,KAAOT,EAAE,EAAE,EACxF,MAAO,CAAE,GAAGA,EAAG,IAAAtB,EAAK,KAAMA,EAAK,IAAA,CACjC,CAAC,EACA,KAAK,CAAC,EAAGoC,IAAMA,EAAE,KAAO,EAAE,IAAI,EAEjC,GAAID,EAAY,SAAW,EAAG,CAC5B,KAAK,KAAK,GAAG,IAAI,YAAY,EAC7B,MACF,CAEA,IAAIE,EAAoD,KACxD,GAAIH,EAAY,GACdG,EAAeF,EAAY,CAAC,MACvB,CACL,UAAWR,KAAQQ,EACjB,GAAIR,EAAK,MAAQM,EAAY,GAAK,CAChCI,EAAeV,EACf,KACF,CAEGU,IACHA,EAAeF,EAAYA,EAAY,OAAS,CAAC,EAErD,CAEA,KAAK,gBAAgBE,EAAa,EAAE,CACtC,CAEA,YAAYzB,EAAqB,CAC/B,MAAMe,EAAO,KAAK,KAAK,UAAU,MAAMf,CAAK,EAC5C,GAAI,CAACe,EAAM,OACX,MAAM3B,EAAM,KAAK,KAAK,OAAO,MAAM,QAAQ,KAAM+B,GAAkBA,EAAE,KAAOJ,EAAK,EAAE,EAEnF,GADI,CAAC3B,GAAO,CAACA,EAAI,OACb,KAAK,KAAK,OAAO,cAAc,SAASA,EAAI,KAAK,EAAG,OACxD,KAAK,KAAK,OAAO,cAAc,KAAKA,EAAI,KAAK,EAC7C,KAAK,WAAW2B,EAAK,GAAI,CAAC,EAC1B,MAAMd,EAAQ,KAAK,KAAK,OAAO,OAAO,KAAKF,GAAKA,EAAE,KAAOX,EAAK,KAAK,EACnE,KAAK,KAAK,GAAG,IAAI,WAAWa,EAAO,IAAI,IAAIA,EAAO,IAAI,GAAG,EACzD,KAAK,KAAK,KAAA,EACV,KAAK,KAAK,GAAG,qBAAA,CACf,CAEA,eAAwB,CACtB,MAAML,EAAW,KAAK,KAAK,UAAU,MAAQ,KAAK,KAAK,OAAO,UAAU,aACxE,OAAO,KAAK,MACV,KAAK,KAAK,OAAO,UAAU,eACzB,KAAK,IAAI,KAAK,KAAK,OAAO,UAAU,qBAAsBA,CAAQ,CAAA,CAExE,CAEA,YAAmB,CACjB,GAAI,KAAK,KAAK,UAAU,OAAS,KAAK,KAAK,OAAO,UAAU,SAAU,OACtE,MAAM8B,EAAO,KAAK,cAAA,EAClB,GAAI,KAAK,KAAK,OAAO,KAAOA,EAAM,CAChC,KAAK,KAAK,GAAG,IAAI,SAAS,EAC1B,MACF,CACA,KAAK,KAAK,OAAO,MAAQA,EACzB,KAAK,KAAK,UAAU,QACpB,KAAK,KAAK,GAAG,IAAI,YAAY,KAAK,KAAK,UAAU,KAAK,KAAK,EAC3D,KAAK,KAAK,KAAA,EACV,KAAK,KAAK,GAAG,OAAA,EACb,KAAK,KAAK,GAAG,qBAAA,CACf,CAEA,SAASX,EAA+B,CACtC,OAAO,OAAO,QAAQA,EAAK,SAAS,EAAE,MAAM,CAAC,CAACY,EAAOnB,CAAK,IACjD,KAAK,aAAamB,CAAK,GAAKnB,CACpC,CACH,CAEA,UAAUH,EAAgCE,EAAsB,CAC9D,MAAMQ,EAAO,KAAK,KAAK,OAAO,UAAUV,CAAQ,EAAE,KAAK,GAAK,EAAE,KAAOE,CAAM,EACtEQ,GACA,KAAK,SAASA,CAAI,IACvB,OAAO,QAAQA,EAAK,SAAS,EAAE,QAAQ,CAAC,CAACY,EAAOnB,CAAK,IAAM,CACzD,KAAK,WAAWmB,EAAOnB,CAAK,CAC9B,CAAC,EACGH,IAAa,UACf,KAAK,KAAK,OAAO,OAASE,EAE1B,KAAK,KAAK,OAAO,MAAQA,EAE3B,KAAK,KAAK,GAAG,IAAI,WAAWQ,EAAK,IAAI,IAAIA,EAAK,IAAI,GAAG,EACrD,KAAK,KAAK,KAAA,EACV,KAAK,KAAK,GAAG,OAAA,EACb,KAAK,KAAK,GAAG,kBAAkBV,CAAQ,EACzC,CACF,CCjMO,MAAMuB,CAAa,CAChB,KACA,SACA,SACA,gBAER,YAAY5C,EAAY,CACtB,KAAK,KAAOA,EACZ,KAAK,aAAe,IACpB,KAAK,aAAe,IACpB,KAAK,oBAAsB,GAC7B,CAEA,aAAa6C,EAA0B,CACrC,MAAMC,EAAW,KAAK,KAAK,OAAO,UAClC,UAAWC,KAAQD,EACjB,GAAID,GAASE,EAAK,WAAW,CAAC,GAAKF,GAASE,EAAK,WAAW,CAAC,EAC3D,OAAOA,EAGX,OAAOD,EAAS,CAAC,CACnB,CAEA,eAAeE,EAAkBC,EAA4E,CAC3G,MAAMF,EAAO,KAAK,aAAaC,CAAQ,EACjCE,EAAU,SAASF,CAAQ,GAGjC,OAFsB,KAAK,SAAS,IAAIE,CAAO,EAMxC,MAHL,KAAK,SAAS,IAAIA,CAAO,EAClB,CAAE,KAAM,OAAQ,KAAMH,EAAM,MAAOC,CAAA,EAG9C,CAEA,SAASH,EAAmD,CAE1D,MAAMM,EADO,KAAK,KAAK,OAAO,KACH,OACzBC,GAAOP,GAASO,EAAI,UAAY,CAAC,KAAK,SAAS,IAAI,GAAGA,EAAI,EAAE,IAAIP,CAAK,EAAE,CAAA,EAGzE,UAAWO,KAAOD,EAChB,GAAI,KAAK,SAAWC,EAAI,YACtB,YAAK,SAAS,IAAI,GAAGA,EAAI,EAAE,IAAIP,CAAK,EAAE,EAC/B,CAAE,KAAM,MAAO,KAAMO,CAAA,EAGhC,OAAO,IACT,CAEA,iBAAiBP,EAA2D,CAE1E,MAAMQ,EADS,KAAK,KAAK,OAAO,aACD,OAAOC,GAAST,GAASS,EAAM,QAAQ,EAEtE,UAAWA,KAASD,EAAiB,CACnC,MAAME,EAAW,GAAGD,EAAM,EAAE,IAAI,KAAK,KAAK,GAC1C,GAAI,KAAK,SAAWA,EAAM,YACxB,YAAK,gBAAgB,IAAIC,CAAQ,EAC1B,CAAE,KAAM,QAAS,KAAMD,CAAA,CAElC,CACA,OAAO,IACT,CAEA,mBAAmBA,EAAkC,CACnD,MAAME,EAASF,EAAM,OACfG,EAAWH,EAAM,SACjBI,EAAUJ,EAAM,OAEhBK,EAAuB,CAAE,KAAM,EAAG,IAAK,EAAG,MAAO,CAAA,EAAI,KAAM,EAAG,KAAM,IAAA,EAU1E,GARIH,IACEA,EAAO,OAAMG,EAAO,KAAOH,EAAO,MAClCA,EAAO,MAAKG,EAAO,IAAMH,EAAO,KAChCA,EAAO,QACTG,EAAO,MAAM,KAAK,CAAE,OAAQH,EAAO,OAAQ,MAAO,EAAG,GAIrDC,GAAYA,EAAS,OAAS,EAAG,CACnC,MAAMG,EAAcH,EAAS,OAAO,CAACI,EAAKC,IAAMD,EAAMC,EAAE,OAAQ,CAAC,EACjE,IAAIC,EAAS,KAAK,OAAA,EAAWH,EAC7B,UAAWI,KAAWP,EAEpB,GADAM,GAAUC,EAAQ,OACdD,GAAU,EAAG,CACXC,EAAQ,OAAML,EAAO,KAAOK,EAAQ,MACpCA,EAAQ,QACVL,EAAO,MAAM,KAAK,CAAE,OAAQK,EAAQ,OAAQ,MAAO,EAAG,EAExD,KACF,CAEJ,CAEA,GAAIN,GAAWA,EAAQ,OAAS,EAAG,CACjC,MAAME,EAAcF,EAAQ,OAAO,CAACG,EAAKI,IAAMJ,EAAMI,EAAE,OAAQ,CAAC,EAChE,IAAIF,EAAS,KAAK,OAAA,EAAWH,EAC7B,UAAWM,KAAUR,EAEnB,GADAK,GAAUG,EAAO,OACbH,GAAU,EAAG,CACXG,EAAO,OAAS,SAAQP,EAAO,KAAOO,EAAO,OAC7CA,EAAO,OAAS,SAAQP,EAAO,KAAOO,EAAO,OAC7CA,EAAO,OAAS,QAAOP,EAAO,IAAMO,EAAO,OAC/C,KACF,CAEJ,CAEA,OAAIZ,EAAM,OACJ,MAAM,QAAQA,EAAM,IAAI,EAC1BK,EAAO,KAAOL,EAAM,KAAK,KAAK,MAAM,KAAK,OAAA,EAAWA,EAAM,KAAK,MAAM,CAAC,EAEtEK,EAAO,KAAOL,EAAM,MAIjBK,CACT,CAEA,iBAAiBP,EAAwB,CACvC,MAAMI,EAASJ,EAAI,OACbO,EAAuB,CAAE,KAAM,EAAG,IAAK,EAAG,MAAO,CAAA,EAAI,KAAM,EAAG,KAAM,IAAA,EAE1E,OAAIH,IACEA,EAAO,OAAMG,EAAO,KAAOH,EAAO,MAClCA,EAAO,MAAKG,EAAO,IAAMH,EAAO,KAChCA,EAAO,QACTG,EAAO,MAAM,KAAK,CAAE,OAAQH,EAAO,OAAQ,MAAO,EAAG,GAIlDG,CACT,CAEA,YAAYA,EAA4B,CAatC,GAZIA,EAAO,MAAQA,EAAO,KAAO,IAC/B,KAAK,KAAK,OAAO,MAAQA,EAAO,MAE9BA,EAAO,KAAOA,EAAO,IAAM,IAC7B,KAAK,KAAK,OAAO,KAAOA,EAAO,IAC/B,KAAK,KAAK,cAAc,QAAA,GAEtBA,EAAO,OAASA,EAAO,MAAM,OAAS,GACxCA,EAAO,MAAM,QAAQ5B,GAAQ,CAC3B,KAAK,KAAK,iBAAiB,QAAQA,EAAK,OAAQA,EAAK,KAAK,CAC5D,CAAC,EAEC4B,EAAO,MAAQA,EAAO,KAAO,EAAG,CAClC,MAAMQ,EAAa,KAAK,IAAIR,EAAO,KAAM,KAAK,KAAK,OAAO,MAAQ,KAAK,KAAK,OAAO,EAAE,EACrF,KAAK,KAAK,OAAO,IAAMQ,CACzB,CACF,CAEA,eAAef,EAAkB,CAC/B,OAAIA,EAAI,WAAaA,EAAI,UAAU,OAAS,EACnCA,EAAI,UAAU,KAAK,MAAM,KAAK,SAAWA,EAAI,UAAU,MAAM,CAAC,EAEhEA,EAAI,QACb,CAEA,iBAA2B,CACzB,OAAO,KAAK,SAAS,KAAO,CAC9B,CAEA,cAAwB,CACtB,MAAO,EACT,CAEA,mBAA6B,CAC3B,OAAO,KAAK,SAAS,KAAO,CAC9B,CAEA,OAAc,CACZ,KAAK,SAAS,MAAA,EACd,KAAK,SAAS,MAAA,EACd,KAAK,gBAAgB,MAAA,CACvB,CAEA,MAAsB,CACpB,MAAO,CACL,SAAU,MAAM,KAAK,KAAK,QAAQ,EAClC,SAAU,MAAM,KAAK,KAAK,QAAQ,EAClC,gBAAiB,MAAM,KAAK,KAAK,eAAe,CAAA,CAEpD,CAEA,KAAKgB,EAAuC,CACtCA,IACF,KAAK,SAAW,IAAI,IAAIA,EAAK,UAAY,CAAA,CAAE,EAC3C,KAAK,SAAW,IAAI,IAAIA,EAAK,UAAY,CAAA,CAAE,EAE/C,CACF,CCxMO,MAAMC,CAAc,CACjB,KAER,YAAYrE,EAAY,CACtB,KAAK,KAAOA,CACd,CAEA,eAAiC,CAC/B,MAAMS,EAAM,KAAK,KAAK,OAAO,MACvB6D,EAAW,KAAK,KAAK,OAAO,SAAS,OAAOC,GAAKA,EAAE,UAAY,KAAK,KAAK,KAAK,EAC9EzC,EAAM,KAAK,MAAM,KAAK,OAAA,EAAWwC,EAAS,MAAM,EAChDC,EAAID,EAASxC,CAAG,EAChB0C,EAAO,GAAK,KAAK,KAAK,MAAQ,GAAK/D,EAAI,qBAC7C,MAAO,CACL,GAAI8D,EAAE,GACN,KAAMA,EAAE,KACR,OAAQA,EAAE,OACV,GAAI,KAAK,MAAMA,EAAE,GAAKC,CAAI,EAC1B,MAAO,KAAK,MAAMD,EAAE,GAAKC,CAAI,EAC7B,IAAK,KAAK,MAAMD,EAAE,IAAMC,CAAI,EAC5B,IAAK,KAAK,MAAMD,EAAE,IAAMC,CAAI,EAC5B,IAAK,KAAK,MAAMD,EAAE,IAAMC,CAAI,EAC5B,KAAM,KAAK,MAAMD,EAAE,KAAOC,CAAI,EAC9B,SAAUD,EAAE,UAAY,GACxB,UAAWA,EAAE,WAAa,GAAA,CAE9B,CAEA,SAAgB,CACV,KAAK,KAAK,WACd,KAAK,KAAK,QAAU,KAAK,cAAA,EACzB,KAAK,KAAK,SAAW,GACrB,KAAK,KAAK,WAAa,EACvB,KAAK,KAAK,GAAG,IAAI,OAAO,KAAK,KAAK,QAAQ,MAAM,IAAI,KAAK,KAAK,QAAQ,IAAI,GAAG,EAC7E,KAAK,KAAK,GAAG,WAAW,CAAE,OAAQ,GAAO,MAAO,GAAO,KAAM,GAAO,UAAW,GAAO,KAAM,GAAM,EAClG,KAAK,KAAK,GAAG,cAAA,EACf,CAEA,WAAWtE,EAAaG,EAAaqE,EAAsB,CACzD,OAAO,KAAK,IAAI,EAAG,KAAK,MAAMxE,EAAMG,EAAM,KAAK,OAAA,EAAWqE,CAAI,CAAC,CACjE,CAEA,QAAe,CACb,GAAI,CAAC,KAAK,KAAK,SAAU,OACzB,MAAMC,EAAM,KAAK,WACf,KAAK,KAAK,cAAc,YAAA,EACxB,KAAK,KAAK,QAAS,IACnB,KAAK,KAAK,OAAO,OAAO,gBAAA,EAE1B,KAAK,WAAWA,EAAK,KAAK,KAAK,KAAK,QAAS,IAAI,MAAM,CACzD,CAEA,SAAShE,EAAuB,CAC9B,GAAI,CAAC,KAAK,KAAK,SAAU,OACzB,MAAMO,EAAQ,KAAK,KAAK,OAAO,OAAO,KAAM,GAAa,EAAE,KAAOP,CAAO,EACzE,GAAKO,EACL,IAAI,KAAK,KAAK,OAAO,eAAeP,CAAO,EAAI,EAAG,CAChD,KAAK,KAAK,GAAG,IAAI,KAAKO,EAAM,IAAI,OAAO,EACvC,MACF,CAGA,GAFA,KAAK,KAAK,OAAO,eAAeP,CAAO,EAAIO,EAAM,GACjD,KAAK,KAAK,GAAG,gBAAA,EACTA,EAAM,OAAS,SAAU,CAC3B,MAAMyD,EAAM,KAAK,WACf,KAAK,KAAK,cAAc,YAAA,GAAiBzD,EAAM,kBAAoB,GACnE,KAAK,KAAK,QAAS,IACnBA,EAAM,YAAc,CAAA,EAEhB0D,EAAM,GAAG1D,EAAM,IAAI,IAAIA,EAAM,IAAI,MAAM,KAAK,KAAK,QAAS,IAAI,OACpE,KAAK,WAAWyD,EAAKC,EAAK1D,CAAK,CACjC,SAAWA,EAAM,OAAS,OAAQ,CAChC,MAAMmB,EAAU,KAAK,MAAM,KAAK,KAAK,OAAO,OAASnB,EAAM,aAAe,EAAE,EAC5E,KAAK,KAAK,OAAO,GAAK,KAAK,IAAI,KAAK,KAAK,OAAO,GAAKmB,EAAS,KAAK,KAAK,OAAO,KAAK,EACpF,KAAK,KAAK,GAAG,IAAI,GAAGnB,EAAM,IAAI,IAAIA,EAAM,IAAI,0BAA0BmB,CAAO,YAAY,EACzF,KAAK,KAAK,GAAG,gBAAgBA,EAAS,EAAI,EAC1C,KAAK,KAAK,GAAG,OAAA,EACb,KAAK,YAAA,CACP,EACF,CAEA,kBAAyB,CACvB,MAAM1B,EAAU,KAAK,KAAK,OAAO,eAAiB,KAAK,KAAK,OAAO,cAAc,CAAC,EAClF,GAAI,CAACA,EAAS,CACZ,KAAK,KAAK,GAAG,IAAI,WAAW,EAC5B,MACF,CACA,MAAMkE,EAAK,KAAK,KAAK,OAAO,eAAelE,CAAO,GAAK,EACvD,GAAIkE,EAAK,EAAG,CACV,MAAM3D,EAAQ,KAAK,KAAK,OAAO,OAAO,KAAMF,GAAaA,EAAE,KAAOL,CAAO,EACzE,KAAK,KAAK,GAAG,IAAI,KAAKO,EAAO,IAAI,SAAS2D,CAAE,MAAM,EAClD,MACF,CACA,KAAK,SAASlE,CAAO,CACvB,CAEA,WAAWgE,EAAaC,EAAa1D,EAAsB,KAAY,CACrE,MAAM4D,EAAiB,KAAK,KAAK,OAAO,UAAY,KAAK,KAAK,OAAO,OAAO,QAAQ,SAC9EC,EAAmB,KAAK,KAAK,QAAS,WAAa,IAEzD,GAAI,KAAK,OAAA,EAAWA,EAAkB,CACpC,KAAK,KAAK,GAAG,IAAI,GAAG,KAAK,KAAK,QAAS,MAAM,IAAI,KAAK,KAAK,QAAS,IAAI,SAAS,EACjF,KAAK,KAAK,GAAG,gBAAgB,EAAG,GAAO,EAAI,EAC3C,KAAK,YAAA,EACL,KAAK,KAAK,GAAG,OAAA,EACb,MACF,CAEA,MAAMC,EAAa,KAAK,OAAA,EAAWF,EACnC,IAAIG,EAAWN,EACXK,IACFC,EAAW,KAAK,MAAMN,EAAM,GAAG,GAGjC,KAAK,KAAK,QAAS,IAAMM,EACzB,MAAMC,EAAWF,EAAa,SAAW,GAQzC,GAPA,KAAK,KAAK,GAAG,IAAI,GAAGJ,CAAG,wBAAwBK,CAAQ,cAAcC,CAAQ,EAAE,EAC/E,KAAK,KAAK,GAAG,gBAAgBD,EAAU,GAAO,GAAOD,CAAU,EAC/D,KAAK,KAAK,GAAG,MAAM,eAAe,EAC9B9D,GAASA,EAAM,OACjB,KAAK,KAAK,WAAaA,EAAM,KAC7B,KAAK,KAAK,GAAG,IAAI,WAAW,GAE1BA,GAASA,EAAM,UAAW,CAC5B,MAAMmB,EAAU,KAAK,MAAM4C,EAAW/D,EAAM,SAAS,EACrD,KAAK,KAAK,OAAO,GAAK,KAAK,IAAI,KAAK,KAAK,OAAO,GAAKmB,EAAS,KAAK,KAAK,OAAO,KAAK,EACpF,KAAK,KAAK,GAAG,IAAI,8BAA8BA,CAAO,YAAY,EAClE,KAAK,KAAK,GAAG,gBAAgBA,EAAS,EAAI,CAC5C,CACA,KAAK,KAAK,GAAG,cAAA,EACT,KAAK,KAAK,QAAS,IAAM,EAC3B,KAAK,OAAA,EAEL,KAAK,YAAA,EAEP,KAAK,KAAK,GAAG,OAAA,CACf,CAEA,aAAoB,CAClB,IAAInC,EAAM,KAAK,KAAK,QAAS,IACzB,KAAK,KAAK,WAAa,IACzBA,EAAM,KAAK,MAAMA,GAAO,EAAI,KAAK,KAAK,WAAW,EACjD,KAAK,KAAK,WAAa,KAAK,IAAI,EAAG,KAAK,KAAK,WAAa,EAAG,GAG/D,MAAMiF,EAAkB,KAAK,KAAK,OAAO,WAAa,KAAK,KAAK,OAAO,OAAO,QAAQ,UACtF,GAAI,KAAK,OAAA,EAAWA,EAAiB,CACnC,KAAK,KAAK,GAAG,IAAI,WAAW,KAAK,KAAK,QAAS,IAAI,OAAO,EAC1D,MACF,CAEA,MAAMC,EAAkB,KAAK,KAAK,QAAS,UAAY,GACjDJ,EAAa,KAAK,OAAA,EAAWI,EAEnC,IAAIT,EAAM,KAAK,WACbzE,EACA,KAAK,KAAK,cAAc,YAAA,EACxB,KAAK,KAAK,OAAO,OAAO,eAAA,EAEtB8E,IACFL,EAAM,KAAK,MAAMA,EAAM,GAAG,GAG5B,KAAK,KAAK,OAAO,IAAMA,EACvB,MAAMO,EAAWF,EAAa,SAAW,GACzC,KAAK,KAAK,GAAG,IACX,GAAG,KAAK,KAAK,QAAS,MAAM,IAAI,KAAK,KAAK,QAAS,IAAI,8BAA8BL,CAAG,cAAcO,CAAQ,EAAA,EAEhH,KAAK,KAAK,GAAG,MAAM,aAAa,EAC5B,KAAK,KAAK,OAAO,IAAM,GAAG,KAAK,KAAK,SAAA,CAC1C,CAEA,QAAe,CACb,KAAK,KAAK,SAAW,GACrB,KAAK,KAAK,SACV,KAAK,KAAK,OAAO,KAAO,KAAK,KAAK,QAAS,IAC3C,KAAK,KAAK,OAAO,MAAQ,KAAK,KAAK,QAAS,KAC5C,KAAK,KAAK,GAAG,IACX,SAAS,KAAK,KAAK,QAAS,IAAI,uBAAuB,KAAK,KAAK,QAAS,GAAG,kCAAkC,KAAK,KAAK,QAAS,IAAI,YAAA,EAExI,KAAK,KAAK,iBAAiB,UAAU,KAAK,KAAK,QAAS,EAAE,EAC1D,KAAK,KAAK,cAAc,gBAAA,EACxB,KAAK,KAAK,cAAc,iBAAA,EACxB,KAAK,KAAK,cAAc,QAAA,EAExB,MAAMG,EAAc,KAAK,KAAK,aAAa,iBAAiB,KAAK,KAAK,KAAK,EAC3E,GAAIA,EAAa,CACf,MAAMzB,EAAS,KAAK,KAAK,aAAa,mBAAmByB,EAAY,IAAI,EACzE,KAAK,KAAK,aAAa,YAAYzB,CAAM,EACzC,WAAW,IAAM,CACf,KAAK,KAAK,GAAG,eAAeyB,EAAY,KAAMzB,CAAM,CACtD,EAAG,GAAG,CACR,CAEA,KAAK,KAAK,KAAA,EACV,KAAK,KAAK,GAAG,mBAAA,EACb,KAAK,KAAK,eAAA,CACZ,CACF,CC3KO,MAAM0B,CAAU,CACb,KAER,YAAYrF,EAAY,CACtB,KAAK,KAAOA,CACd,CAEA,IAAI2E,EAAmB,CACrB,MAAMW,EAAMzF,EAAE,WAAW,EACzB,GAAI,CAACyF,EAAK,OACV,MAAMC,EAAI,SAAS,cAAc,GAAG,EACpCA,EAAE,UAAYZ,EACdW,EAAI,YAAYC,CAAC,EACjBD,EAAI,UAAYA,EAAI,aACpB,MAAME,EAAaF,EAAI,WACnBA,EAAI,SAAS,OAAS,IAAME,GAC9BF,EAAI,YAAYE,CAAU,CAE9B,CAEA,MAAMC,EAAmB,CACvB,MAAMC,EAAK,SAAS,cAAcD,CAAG,EAChCC,IACLA,EAAG,UAAU,IAAI,OAAO,EACxB,WAAW,IAAMA,EAAG,UAAU,OAAO,OAAO,EAAG,GAAG,EACpD,CAEA,gBAAgBC,EAAeC,EAAiBC,EAAmB,GAAOd,EAAsB,GAAa,CAC3G,MAAMe,EAAQ,SAAS,cAAc,KAAK,EAC1C,IAAIC,EAAY,eACZH,IAAQG,GAAa,eACrBF,IAASE,GAAa,gBACtBhB,IAAYgB,GAAa,mBAC7BD,EAAM,UAAYC,EAEdF,EACFC,EAAM,YAAc,OAEpBA,EAAM,aAAeF,EAAS,IAAM,KAAOD,GAASZ,EAAa,IAAM,IAGzE,MAAMiB,EAAc,SAAS,cAAc,eAAe,EAC1D,GAAIA,EAAa,CACf,MAAMC,EAAOD,EAAY,sBAAA,EACzBF,EAAM,MAAM,KAAOG,EAAK,KAAOA,EAAK,MAAQ,EAAI,GAAK,KAAK,OAAA,EAAW,GAAK,KAC1EH,EAAM,MAAM,IAAMG,EAAK,IAAMA,EAAK,OAAS,EAAI,IACjD,CACA,SAAS,KAAK,YAAYH,CAAK,EAC/B,WAAW,IAAMA,EAAM,OAAA,EAAU,GAAG,CACtC,CAEA,QAAe,CACb,MAAMP,EAAI,KAAK,KAAK,OACdW,EAAcrG,EAAE,aAAa,EAC7BsG,EAAWtG,EAAE,UAAU,EACvBuG,EAAcvG,EAAE,aAAa,EAC7BwG,EAAYxG,EAAE,WAAW,EACzByG,EAAYzG,EAAE,WAAW,EACzB0G,EAAY1G,EAAE,WAAW,EACzB2G,EAAe3G,EAAE,cAAc,EAC/B4G,EAAa5G,EAAE,YAAY,EAC3B6G,EAAe7G,EAAE,cAAc,EAC/B8G,EAAS9G,EAAE,QAAQ,EACnB+G,EAAS/G,EAAE,QAAQ,EAErBqG,IAAaA,EAAY,YAAc,OAAOX,EAAE,KAAK,GACrDY,IAAUA,EAAS,YAAc,OAAOZ,EAAE,EAAE,GAC5Ca,IAAaA,EAAY,YAAc,OAAOb,EAAE,KAAK,GACrDc,MAAqB,YAAc,OAAO,KAAK,KAAK,cAAc,aAAa,GAC/EC,MAAqB,YAAc,OAAO,KAAK,KAAK,cAAc,aAAa,GAC/EC,IAAWA,EAAU,YAAc,OAAOhB,EAAE,GAAG,GAC/CiB,IAAcA,EAAa,YAAc,OAAOjB,EAAE,MAAM,GACxDkB,IAAYA,EAAW,YAAc,OAAO,KAAK,KAAK,OAAO,IAAI,GACjEC,IAAcA,EAAa,YAAc,OAAO,KAAK,KAAK,KAAK,GAEnE,MAAMpE,EAAY,KAAK,IAAI,EAAIiD,EAAE,GAAKA,EAAE,MAAS,GAAG,EAC9CsB,EAAa,KAAK,IAAI,EAAItB,EAAE,IAAMA,EAAE,OAAU,GAAG,EACnDoB,IAASA,EAAuB,MAAM,MAAQ,GAAGrE,CAAS,KAC1DsE,IAASA,EAAuB,MAAM,MAAQ,GAAGC,CAAU,KAE/D,KAAK,mBAAA,EACL,KAAK,gBAAA,CACP,CAEA,oBAA2B,CACzB,MAAMC,EAAS,KAAK,KAAK,qBAAA,EACnBC,EAAgB,KAAK,IAAI,KAAK,KAAK,OAAQD,CAAM,EACjDE,EAAanH,EAAE,cAAc,EAC9BmH,IACLA,EAAW,YAAc,GAAGD,CAAa,IAAID,CAAM,GAC/C,KAAK,KAAK,QAAUA,EACtBE,EAAW,UAAU,IAAI,UAAU,EAEnCA,EAAW,UAAU,OAAO,UAAU,EAE1C,CAEA,iBAAwB,CACtB,MAAMC,EAAWpH,EAAE,cAAc,EAC3BqH,EAAUrH,EAAE,aAAa,EAC/B,GAAI,KAAK,KAAK,OAAO,OAAQ,CAC3B,MAAMM,EAAI,KAAK,KAAK,OAAO,UAAU,QAAQ,KAAMgH,GAAeA,EAAG,KAAO,KAAK,KAAK,OAAO,MAAM,EAC/FF,IAAUA,EAAS,YAAc9G,EAAIA,EAAE,KAAO,IACpD,MACM8G,MAAmB,YAAc,KAEvC,GAAI,KAAK,KAAK,OAAO,MAAO,CAC1B,MAAM3G,EAAI,KAAK,KAAK,OAAO,UAAU,OAAO,KAAM8G,GAAcA,EAAG,KAAO,KAAK,KAAK,OAAO,KAAK,EAC5FF,IAASA,EAAQ,YAAc5G,EAAIA,EAAE,KAAO,IAClD,MACM4G,MAAiB,YAAc,IAEvC,CAEA,eAAsB,CACpB,GAAI,CAAC,KAAK,KAAK,QAAS,OACxB,MAAMG,EAAgBxH,EAAE,eAAe,EACjCyH,EAAczH,EAAE,aAAa,EAC7B0H,EAAY1H,EAAE,WAAW,EACzB2H,EAAe3H,EAAE,cAAc,EAC/B4H,EAAgB5H,EAAE,eAAe,EAEnCwH,IAAeA,EAAc,YAAc,KAAK,KAAK,QAAQ,QAC7DC,IAAaA,EAAY,YAAc,KAAK,KAAK,QAAQ,MACzDC,IAAWA,EAAU,YAAc,OAAO,KAAK,IAAI,EAAG,KAAK,KAAK,QAAQ,EAAE,CAAC,GAC3EC,IAAcA,EAAa,YAAc,OAAO,KAAK,KAAK,QAAQ,KAAK,GACvEC,IACDA,EAA8B,MAAM,MAAQ,GAAG,KAAK,IAAI,EAAI,KAAK,KAAK,QAAQ,GAAK,KAAK,KAAK,QAAQ,MAAS,GAAG,CAAC,IAEvH,CAEA,WAAW,CAAE,OAAAC,EAAQ,MAAAzG,EAAO,KAAAc,EAAM,KAAA4F,GAA2B,CAC3D,MAAMC,EAAY/H,EAAqB,WAAW,EAC5CgI,EAAWhI,EAAqB,UAAU,EAC1CiI,EAAUjI,EAAqB,SAAS,EACxCkI,EAAelI,EAAqB,cAAc,EAKxD,GAHI+H,MAAqB,SAAWF,GAChCG,MAAmB,SAAW5G,GAC9B6G,MAAiB,SAAW/F,GAC5BgG,EAAc,CAChB,MAAMC,EAAoBL,GAAQ,CAAC,KAAK,KAAK,gBAC7CI,EAAa,SAAWC,EACpB,KAAK,KAAK,iBAAmB,CAACL,EAChCI,EAAa,UAAU,IAAI,aAAa,EAExCA,EAAa,UAAU,OAAO,aAAa,CAE/C,CACF,CAEA,oBAA2B,CACzB,KAAK,KAAK,gBAAkB,KAAK,KAAK,QAAU,KAAK,KAAK,qBAAA,EAC1D,KAAK,WAAW,CACd,OAAQ,GACR,MAAO,GACP,KAAM,GACN,UAAW,GACX,KAAM,CAAC,KAAK,KAAK,eAAA,CAClB,CACH,CAEA,iBAAwB,CACtB,MAAMrH,EAAU,KAAK,KAAK,OAAO,eAAiB,KAAK,KAAK,OAAO,cAAc,CAAC,EAC5EuH,EAAMpI,EAAqB,UAAU,EACrCqI,EAAmBrI,EAAE,kBAAkB,EAE7C,GAAIoI,GAAOC,EAAkB,CAC3B,GAAIxH,EAAS,CACX,MAAMO,EAAQ,KAAK,KAAK,OAAO,OAAO,KAAMF,GAAaA,EAAE,KAAOL,CAAO,EACzE,GAAIO,EAAO,CACT,MAAM2D,EAAK,KAAK,KAAK,OAAO,eAAelE,CAAO,GAAK,EACnDkE,EAAK,GACPsD,EAAiB,YAAc,GAAGjH,EAAM,IAAI,QAAQ2D,CAAE,IACtDqD,EAAI,UAAU,IAAI,aAAa,IAE/BC,EAAiB,YAAcjH,EAAM,KACrCgH,EAAI,UAAU,OAAO,aAAa,GAEpC,MACF,CACF,CACAC,EAAiB,YAAc,MAC/BD,EAAI,UAAU,OAAO,aAAa,CACpC,CACF,CAEA,YAAY1H,EAAeE,EAAqD,CAC9E,MAAM0H,EAAWtI,EAAE,UAAU,EACvBuI,EAAYvI,EAAE,WAAW,EACzBwI,EAAaxI,EAAE,YAAY,EAC3ByI,EAAazI,EAAE,YAAY,EAC3B0I,EAAe1I,EAAE,cAAc,EAEjCsI,IAAUA,EAAS,YAAc,OAAO5H,CAAK,GAC7C6H,IAAWA,EAAU,YAAc,IAAI3H,EAAI,EAAE,IAC7C4H,IAAYA,EAAW,YAAc,IAAI5H,EAAI,GAAG,IAChD6H,IAAYA,EAAW,YAAc,IAAI7H,EAAI,GAAG,IAChD8H,GAAcA,EAAa,UAAU,IAAI,MAAM,CACrD,CAEA,mBAA0B,CACxB,MAAMA,EAAe1I,EAAE,cAAc,EACjC0I,GAAcA,EAAa,UAAU,OAAO,MAAM,CACxD,CAEA,eAAsB,CACpB,KAAK,qBAAA,EACL,MAAMC,EAAiB3I,EAAE,gBAAgB,EACrC2I,GAAgBA,EAAe,UAAU,IAAI,MAAM,CACzD,CAEA,sBAA6B,CAC3B,MAAMC,EAAW,CACf,GAAG,KAAK,KAAK,OAAO,MAAM,YAC1B,GAAG,KAAK,KAAK,OAAO,MAAM,UAC1B,GAAG,KAAK,KAAK,OAAO,MAAM,OAAA,EAE5B,IAAIC,EAAO;AAAA,qBACM,KAAK,KAAK,UAAU,MAAM,MAAM,IAAI,KAAK,KAAK,UAAU,KAAK,WAC9E,GAAI,KAAK,KAAK,UAAU,MAAQ,KAAK,KAAK,OAAO,UAAU,SAAU,CACnE,MAAMhG,EAAO,KAAK,KAAK,iBAAiB,cAAA,EACxCgG,GAAQ,iEAAiEhG,CAAI,cAC/E,CACAgG,GAAQ,qCACR,KAAK,KAAK,UAAU,MAAM,QAAQ,CAAC3G,EAAMD,IAAQ,CAC/C,MAAM1B,EAAMqI,EAAS,QAAUtG,EAAE,KAAOJ,EAAK,EAAE,EAC1C3B,IACLsI,GAAQ,sDAAsD5G,CAAG;AAAA,iCACtC1B,EAAI,IAAI;AAAA,iCACRA,EAAI,IAAI;AAAA,mCACN2B,EAAK,KAAK;AAAA,cAEzC,CAAC,EACG,KAAK,KAAK,UAAU,MAAM,SAAW,IACvC2G,GAAQ,mCAEVA,GAAQ,SACR,MAAMC,EAAmB9I,EAAE,kBAAkB,EACzC8I,MAAmC,UAAYD,EACrD,CAEA,eAAe1H,EAAqB,CAClC,MAAMe,EAAO,KAAK,KAAK,UAAU,MAAMf,CAAK,EAC5C,GAAI,CAACe,EAAM,OAMX,MAAM3B,EALW,CACf,GAAG,KAAK,KAAK,OAAO,MAAM,YAC1B,GAAG,KAAK,KAAK,OAAO,MAAM,UAC1B,GAAG,KAAK,KAAK,OAAO,MAAM,OAAA,EAEP,QAAU+B,EAAE,KAAOJ,EAAK,EAAE,EAC/C,GAAI,CAAC3B,EAAK,OACV,IAAIsI,EAAO;AAAA,YACHtI,EAAI,IAAI,IAAIA,EAAI,IAAI,KAAK2B,EAAK,KAAK,QAC3C,MAAM6G,EAAgBxI,EAChByI,EAAYzI,EAClB,GAAIwI,EAAc,KAChBF,GAAQ,SAASE,EAAc,IAAI,UAC/B,CAAC,KAAK,KAAK,UAAY,KAAK,KAAK,OAAO,GAAK,KAAK,KAAK,OAAO,MAChEF,GAAQ,qDAAqD1H,CAAK,iBACzD,KAAK,KAAK,SACnB0H,GAAQ,8BAERA,GAAQ,mCAEDG,EAAU,MAAO,CAC1B,MAAM5H,EAAQ,KAAK,KAAK,OAAO,OAAO,KAAMF,GAAaA,EAAE,KAAO8H,EAAU,KAAK,EAC7E5H,GAAS,KAAK,KAAK,OAAO,cAAc,SAAS4H,EAAU,KAAK,EAClEH,GAAQ,uBAAuBzH,EAAM,IAAI,OAChCA,IACTyH,GAAQ,WAAWzH,EAAM,IAAI,IAAIA,EAAM,IAAI,OAC3CyH,GAAQ,yDAAyD1H,CAAK,iBAE1E,MACE0H,GAAQ,2BAEVA,GAAQ,SACR,MAAMC,EAAmB9I,EAAE,kBAAkB,EACzC8I,MAAmC,UAAYD,EACrD,CAEA,cAAqB,CACnB,GAAI,CAAC,KAAK,KAAK,SAAU,OACzB,MAAMnG,EAAc,KAAK,KAAK,UAAU,MAAM,OAAOb,GAAK,CACxD,MAAMtB,EAAM,KAAK,KAAK,OAAO,MAAM,YAAY,KAAM+B,GAAsBA,EAAE,KAAOT,EAAE,EAAE,EACxF,OAAOtB,GAAOA,EAAI,IACpB,CAAC,EACD,IAAIsI,EAAO,GACPnG,EAAY,SAAW,EACzBmG,EAAO,oCAEPA,EAAO,6BACPnG,EAAY,QAAQR,GAAQ,CAC1B,MAAM3B,EAAM,KAAK,KAAK,OAAO,MAAM,YAAY,KAAM+B,GAAsBA,EAAE,KAAOJ,EAAK,EAAE,EACvF3B,IACFsI,GAAQ,2DAA2D3G,EAAK,EAAE;AAAA,sCAC9C3B,EAAI,IAAI;AAAA,sCACRA,EAAI,IAAI;AAAA,wCACN2B,EAAK,KAAK;AAAA,yCACT3B,EAAI,IAAI;AAAA,kBAG3C,CAAC,EACDsI,GAAQ,UAEV,MAAMI,EAAWjJ,EAAE,UAAU,EACvBkJ,EAAYlJ,EAAE,WAAW,EAC3BiJ,MAAmB,UAAYJ,GAC/BK,GAAWA,EAAU,UAAU,IAAI,MAAM,CAC/C,CAEA,eAAsB,CACpB,MAAMC,EAAU,KAAK,KAAK,OAAO,cAC3BC,EAAkB,KAAK,KAAK,OAAO,eAAiBD,EAAQ,CAAC,EACnE,IAAIN,EAAO,kCACXM,EAAQ,QAAQtI,GAAW,CACzB,MAAMO,EAAQ,KAAK,KAAK,OAAO,OAAO,KAAMF,GAAaA,EAAE,KAAOL,CAAO,EACzE,GAAI,CAACO,EAAO,OACZ,MAAM2D,EAAK,KAAK,KAAK,OAAO,eAAelE,CAAO,GAAK,EACjDwI,EAAaxI,IAAYuI,EAC/BP,GAAQ,iCAAiCQ,EAAa,WAAa,EAAE;AAAA,mCACxCjI,EAAM,IAAI,IAAIA,EAAM,IAAI,GAAG2D,EAAK,EAAI,KAAKA,CAAE,IAAM,EAAE;AAAA,mCACnDsE,EAAa,eAAiB,EAAE,gCAAgCxI,CAAO,OAAOwI,EAAa,KAAO,IAAI;AAAA,aAErI,CAAC,EACDR,GAAQ,SACJM,EAAQ,SAAW,IACrBN,EAAO,2DAET,MAAMS,EAAmBtJ,EAAE,kBAAkB,EACvCuJ,EAAavJ,EAAE,YAAY,EAC7BsJ,MAAmC,UAAYT,GAC/CU,GAAYA,EAAW,UAAU,IAAI,MAAM,CACjD,CAEA,iBAAwB,CACtB,MAAMA,EAAavJ,EAAE,YAAY,EAC7BuJ,GAAYA,EAAW,UAAU,OAAO,MAAM,EAClD,MAAMJ,EAAU,KAAK,KAAK,OAAO,cAC3BrI,EAAW,KAAK,KAAK,OAAO,eAC5BC,EAAW,KAAK,KAAK,cAAc,sBAAA,EACzC,IAAI8H,EAAO,4BAA4B9H,CAAQ,YAC/C8H,GAAQ,kCACR,QAAShH,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,MAAM2H,EAAa3H,EAAId,EACjB0I,EAAa3I,EAASe,CAAC,EACvBT,EAAQqI,EAAa,KAAK,KAAK,OAAO,OAAO,KAAMvI,GAAaA,EAAE,KAAOuI,CAAU,EAAI,KAE7F,GADAZ,GAAQ,0BAA0BW,EAAa,GAAK,QAAQ,KACxDA,EACEpI,GACFyH,GAAQ,SAASzH,EAAM,IAAI,IAAIA,EAAM,IAAI,UACzCyH,GAAQ,wDAAwDhH,CAAC,kBAEjEgH,GAAQ,qCAEL,CACL,MAAMa,EAAc,KAAK,KAAK,OAAO,OAAO,WAAW7H,CAAC,EACxDgH,GAAQ,6BAA6Ba,CAAW,WAClD,CACAb,GAAQ,QACV,CACAA,GAAQ,SACRA,GAAQ,8FACRM,EAAQ,QAAQtI,GAAW,CACzB,GAAIC,EAAS,SAASD,CAAO,EAAG,OAChC,MAAMO,EAAQ,KAAK,KAAK,OAAO,OAAO,KAAMF,GAAaA,EAAE,KAAOL,CAAO,EACpEO,IACLyH,GAAQ;AAAA,gBACEzH,EAAM,IAAI,IAAIA,EAAM,IAAI;AAAA,8DACsBP,CAAO;AAAA,cAEjE,CAAC,EACDgI,GAAQ,SACR,MAAMc,EAAqB3J,EAAE,oBAAoB,EAC3C4J,EAAmB5J,EAAE,kBAAkB,EACzC2J,MAAuC,UAAYd,GACnDe,GAAkBA,EAAiB,UAAU,IAAI,MAAM,CAC7D,CAEA,WAAkB,CAChB,KAAK,iBAAA,EACL,MAAMC,EAAa7J,EAAE,YAAY,EAC7B6J,GAAYA,EAAW,UAAU,IAAI,MAAM,CACjD,CAEA,kBAAyB,CACvB,IAAIhB,EAAO,2BACXA,GAAQ,4FACRA,GAAQ,qFACRA,GAAQ,SACRA,GAAQ,6BACR,MAAMiB,EAAe9J,EAAE,cAAc,EACjC8J,MAA2B,UAAYjB,GAC3C,KAAK,kBAAkB,SAAS,CAClC,CAEA,kBAAkBrH,EAAsC,CACtD,SAAS,iBAAiB,sBAAsB,EAAE,QAAQ,CAAC4G,EAAKnG,IAAQ,CACtEmG,EAAI,UAAU,OAAO,SAAW5G,IAAa,WAAaS,IAAQ,GAAOT,IAAa,UAAYS,IAAQ,CAAE,CAC9G,CAAC,EACD,MAAM8H,EAAQ,KAAK,KAAK,OAAO,UAAUvI,CAAQ,EAC3CwI,EAAexI,IAAa,UAAY,KAAK,KAAK,OAAO,OAAS,KAAK,KAAK,OAAO,MACzF,IAAIqH,EAAO,2BACXkB,EAAM,QAAS7H,GAAyB,CACtC,MAAM+H,EAAaD,IAAiB9H,EAAK,GACnCgI,EAAW,KAAK,KAAK,iBAAiB,SAAShI,CAAI,EACzD2G,GAAQ,0BAA0BoB,EAAa,WAAa,EAAE,KAC9DpB,GAAQ;AAAA,mCACqB3G,EAAK,IAAI;AAAA,mCACTA,EAAK,IAAI;AAAA,mCACTV,IAAa,UAAY,OAAQU,EAAgB,GAAG,GAAK,OAAQA,EAAe,GAAG,EAAE;AAAA,UAC9G+H,EAAa,0CAA4C,EAAE;AAAA,cAE/DpB,GAAQ,2BACR,OAAO,QAAQ3G,EAAK,SAAS,EAAE,QAAQ,CAAC,CAACY,EAAOnB,CAAK,IAAM,CACzD,MAAMwI,EAAM,KAAK,KAAK,OAAO,MAAM,UAAU,KAAKzF,GAAKA,EAAE,KAAO5B,CAAK,EAC/DsH,EAAO,KAAK,KAAK,iBAAiB,aAAatH,CAAK,EACpDuH,EAASD,GAAQzI,EACvBkH,GAAQ,oBAAoBwB,EAAS,GAAK,MAAM,KAAKF,EAAMA,EAAI,KAAO,GAAG,IAAIC,CAAI,IAAIzI,CAAK,SAC5F,CAAC,EACDkH,GAAQ,SACJoB,EACFpB,GAAQ,8DAA8DrH,CAAQ,kBACrE0I,EACTrB,GAAQ,0DAA0DrH,CAAQ,OAAOU,EAAK,EAAE,kBAExF2G,GAAQ,gEAEVA,GAAQ,QACV,CAAC,EACDA,GAAQ,SACR,MAAMyB,EAAYtK,EAAE,WAAW,EAC3BsK,MAAqB,UAAYzB,EACvC,CAEA,YAAY0B,EAAiBC,EAA6B,CACxD,MAAMC,EAAiBzK,EAAE,gBAAgB,EACnC0K,EAAa1K,EAAqB,YAAY,EAC9C2K,EAAe3K,EAAE,cAAc,EACjCyK,MAA+B,YAAcF,GAC7CG,IACFA,EAAW,QAAU,IAAM,CACzB,KAAK,aAAA,EACLF,EAAA,CACF,GAEEG,GAAcA,EAAa,UAAU,IAAI,MAAM,CACrD,CAEA,cAAqB,CACnB,MAAMA,EAAe3K,EAAE,cAAc,EACjC2K,GAAcA,EAAa,UAAU,OAAO,MAAM,CACxD,CAEA,cAAqB,CACnB,MAAMC,EAAgB5K,EAAE,eAAe,EACnC4K,GAAeA,EAAc,UAAU,IAAI,MAAM,CACvD,CAEA,gBAAuB,CACrB,SAAS,iBAAiB,QAAQ,EAAE,WAAalG,EAAE,UAAU,OAAO,MAAM,CAAC,CAC7E,CAEA,uBAAuB1B,EAAqB,CAC1C,MAAME,EAAO,KAAK,KAAK,aAAa,aAAaF,CAAK,EAChD6H,EAAa,SAAS,cAAc,cAAc,EACpDA,GAAc3H,IACf2H,EAA2B,UAAY,eAAe3H,EAAK,OAAO,GAEvE,CAEA,cAAcA,EAAiBF,EAAqB,CAClD,MAAM8H,EAAW9K,EAAE,UAAU,EACvB+K,EAAY/K,EAAE,WAAW,EACzBgL,EAAkBhL,EAAE,iBAAiB,EACrCiL,EAAcjL,EAAE,aAAa,EAC7BkL,EAAalL,EAAE,YAAY,EAE7B8K,IAAUA,EAAS,YAAc5H,EAAK,MACtC6H,IAAWA,EAAU,YAAc,GAAG7H,EAAK,IAAI,OAAOF,CAAK,KAC3DgI,IAAiBA,EAAgB,YAAc9H,EAAK,aACpD+H,IAAaA,EAAY,YAAc/H,EAAK,MAC5CgI,GAAYA,EAAW,UAAU,IAAI,MAAM,CACjD,CAEA,iBAAwB,CACtB,MAAMA,EAAalL,EAAE,YAAY,EAC7BkL,GAAYA,EAAW,UAAU,OAAO,MAAM,CACpD,CAEA,aAAa3H,EAAgB,CAC3B,MAAM4H,EAAYnL,EAAE,WAAW,EACzBoL,EAAUpL,EAAE,SAAS,EACrBqL,EAAcrL,EAAE,aAAa,EAC7BsL,EAActL,EAAE,aAAa,EAC7BuL,EAAavL,EAAE,YAAY,EAC3BwL,EAAWxL,EAAE,UAAU,EAEzBmL,IAAWA,EAAU,YAAc5H,EAAI,QACvC6H,IAASA,EAAQ,YAAc7H,EAAI,MACnC8H,IAAaA,EAAY,YAAc9H,EAAI,UAE/C,MAAMkI,EAAW,KAAK,KAAK,aAAa,eAAelI,CAAG,EACtD+H,MAAyB,YAAcG,GAE3C,IAAIC,EAAc,GACdnI,EAAI,MAAQA,EAAI,KAAK,OAAS,IAChCmI,EAAc,yBACdnI,EAAI,KAAK,QAAQrB,GAAQ,CACvB,MAAMN,EACJ,KAAK,KAAK,OAAO,MAAM,YAAY,KAAMC,GAAsBA,EAAE,KAAOK,EAAK,MAAM,GACnF,KAAK,KAAK,OAAO,MAAM,QAAQ,KAAML,GAAkBA,EAAE,KAAOK,EAAK,MAAM,EAC7E,GAAIN,EAAS,CACX,MAAM+J,EAAS,KAAK,KAAK,OAAO,MAAQzJ,EAAK,MAC7CwJ,GAAe,yBAAyBC,EAAS,GAAK,UAAU,cAAcA,EAAS,oBAAoBpI,EAAI,EAAE,OAAOrB,EAAK,MAAM,KAAO,EAAE;AAAA,oBAClIN,EAAQ,IAAI,IAAIA,EAAQ,IAAI;AAAA,oBAC5BM,EAAK,KAAK;AAAA,iBAEtB,CACF,CAAC,EACDwJ,GAAe,UAGbnI,EAAI,SACNmI,GAAe,kEAAkEnI,EAAI,EAAE,qBAGzFmI,GAAe,+EACXH,MAAuB,UAAYG,GACnCF,GAAUA,EAAS,UAAU,IAAI,MAAM,CAC7C,CAEA,eAAsB,CACpB,MAAMA,EAAWxL,EAAE,UAAU,EACzBwL,GAAUA,EAAS,UAAU,OAAO,MAAM,CAChD,CAEA,eAAe/H,EAAoBK,EAA4B,CAC7D,MAAM8H,EAAY5L,EAAE,WAAW,EACzB6L,EAAY7L,EAAE,WAAW,EACzB8L,EAAmB9L,EAAE,kBAAkB,EACvC+L,EAAc/L,EAAE,aAAa,EAC7BgM,EAAahM,EAAE,YAAY,EAE7B4L,IAAWA,EAAU,YAAcnI,EAAM,MACzCoI,IAAWA,EAAU,YAAcpI,EAAM,MACzCqI,IAAkBA,EAAiB,YAAcrI,EAAM,aAE3D,IAAIwI,EAAa,GACbnI,EAAO,OACTmI,GAAc,yBAAyBnI,EAAO,IAAI,QAEhDA,EAAO,KAAO,IAChBmI,GAAc,YAAYnI,EAAO,IAAI,WAEnCA,EAAO,IAAM,IACfmI,GAAc,WAAWnI,EAAO,GAAG,WAEjCA,EAAO,KAAO,IAChBmI,GAAc,YAAYnI,EAAO,IAAI,WAEnCA,EAAO,OAASA,EAAO,MAAM,OAAS,GACxCA,EAAO,MAAM,QAAQ5B,GAAQ,CAC3B,MAAMN,EACJ,KAAK,KAAK,OAAO,MAAM,YAAY,KAAMC,GAAsBA,EAAE,KAAOK,EAAK,MAAM,GACnF,KAAK,KAAK,OAAO,MAAM,QAAQ,KAAML,GAAkBA,EAAE,KAAOK,EAAK,MAAM,EACzEN,IACFqK,GAAc,YAAYrK,EAAQ,IAAI,IAAIA,EAAQ,IAAI,OAE1D,CAAC,EAECmK,MAAyB,UAAYE,GACrCD,GAAYA,EAAW,UAAU,IAAI,MAAM,CACjD,CAEA,iBAAwB,CACtB,MAAMA,EAAahM,EAAE,YAAY,EAC7BgM,GAAYA,EAAW,UAAU,OAAO,MAAM,CACpD,CACF,CCxlBO,MAAME,CAAK,CAChB,OACA,MAAgB,EAChB,OAAiB,EACjB,QAAkC,KAClC,SAAoB,GACpB,WAAqB,EACrB,gBAA2B,GAC3B,OACA,UAEA,GACA,OACA,cACA,iBACA,aAEA,YAAYC,EAAoB,CAC9B,KAAK,OAASA,EACd,KAAK,GAAK,IAAI3G,EAAU,IAAI,EAC5B,KAAK,OAAS,IAAIhB,EAAc,IAAI,EACpC,KAAK,cAAgB,IAAItE,EAAc,IAAI,EAC3C,KAAK,iBAAmB,IAAIuB,EAAiB,IAAI,EACjD,KAAK,aAAe,IAAIsB,EAAa,IAAI,CAC3C,CAEA,MAAa,CACX,KAAK,KAAA,EACL,KAAK,WAAA,EACL,KAAK,GAAG,gBAAA,EACR,KAAK,GAAG,OAAA,EACR,WAAW,IAAM,KAAK,QAAA,EAAW,GAAG,CACtC,CAEA,MAAa,CACX,MAAMwB,EAAiB,CACrB,OAAQ,KAAK,OACb,MAAO,KAAK,MACZ,OAAQ,KAAK,OACb,UAAW,KAAK,UAChB,MAAO,KAAK,aAAa,KAAA,CAAK,EAEhC,aAAa,QAAQ,iBAAkB,KAAK,UAAUA,CAAI,CAAC,CAC7D,CAEA,MAAa,CACX,MAAM6H,EAAQ,aAAa,QAAQ,gBAAgB,EACnD,GAAIA,EAAO,CACT,MAAM7H,EAAiB,KAAK,MAAM6H,CAAK,EACvC,KAAK,OAAS7H,EAAK,OACnB,KAAK,MAAQA,EAAK,MAClB,KAAK,OAASA,EAAK,OACnB,KAAK,UAAYA,EAAK,WAAa,CAAE,MAAO,KAAK,OAAO,UAAU,aAAc,MAAO,CAAA,CAAC,EACxF,KAAK,cAAc,eAAA,EACnB,KAAK,aAAa,KAAKA,EAAK,KAAK,EACjC,KAAK,gBAAkB,KAAK,QAAU,KAAK,qBAAA,CAC7C,MACE,KAAK,cAAc,KAAA,EACnB,KAAK,iBAAiB,KAAA,CAE1B,CAEA,YAAmB,CACjB,MAAMwD,EAAY/H,EAAE,WAAW,EACzBgI,EAAWhI,EAAE,UAAU,EACvBiI,EAAUjI,EAAE,SAAS,EACrBkI,EAAelI,EAAE,cAAc,EAC/BqM,EAAcrM,EAAE,aAAa,EAC7BsM,EAAYtM,EAAE,WAAW,EAE3B+H,IAAWA,EAAU,QAAU,IAAM,KAAK,OAAO,OAAA,GACjDC,IAAUA,EAAS,QAAU,IAAM,KAAK,OAAO,iBAAA,GAC/CC,IAASA,EAAQ,QAAU,IAAM,KAAK,iBAAiB,aAAA,GACvDC,IAAcA,EAAa,QAAU,IAAM,KAAK,UAAA,GAChDmE,IAAaA,EAAY,QAAU,IAAM,KAAK,GAAG,aAAA,GACjDC,IACFA,EAAU,QAAU,IAAM,CACxB,MAAM1B,EAAgB5K,EAAE,eAAe,EACnC4K,GAAeA,EAAc,UAAU,OAAO,MAAM,EACxD,KAAK,GAAG,YAAY,oBAAqB,IAAM,KAAK,WAAW,CACjE,EACJ,CAEA,WAAkB,CAChB,aAAa,WAAW,gBAAgB,EACxC,KAAK,cAAc,KAAA,EACnB,KAAK,iBAAiB,KAAA,EACtB,KAAK,aAAa,MAAA,EAClB,KAAK,MAAQ,EACb,KAAK,OAAS,EACd,KAAK,QAAU,KACf,KAAK,SAAW,GAChB,KAAK,WAAa,EAClB,KAAK,gBAAkB,GACvB,MAAM2B,EAAYvM,EAAE,WAAW,EAC3BuM,MAAqB,UAAY,0BACrC,KAAK,GAAG,WAAW,CAAE,OAAQ,GAAM,MAAO,GAAM,KAAM,GAAM,UAAW,GAAO,KAAM,GAAM,EAC1F,KAAK,GAAG,uBAAuB,CAAC,EAChC,KAAK,GAAG,OAAA,EACR,KAAK,GAAG,eAAA,CACV,CAEA,WAAkB,CAChB,MAAMC,EAAW,KAAK,MACtB,KAAK,QACL,KAAK,OAAS,EACd,KAAK,GAAG,IAAI,UAAU,KAAK,KAAK,KAAK,EACrC,MAAMtE,EAAelI,EAAqB,cAAc,EACpDkI,MAA2B,SAAW,IAE1C,KAAK,GAAG,uBAAuB,KAAK,KAAK,EAEzC,MAAMuE,EAAY,KAAK,aAAa,eAAe,KAAK,MAAOD,CAAQ,EACnEC,GACF,KAAK,GAAG,cAAcA,EAAU,KAAM,KAAK,KAAK,EAGlD,MAAMC,EAAW,KAAK,aAAa,SAAS,KAAK,KAAK,EAClDA,GACF,WAAW,IAAM,CACf,KAAK,GAAG,aAAaA,EAAS,IAAI,CACpC,EAAGD,EAAY,IAAO,GAAG,EAG3B,KAAK,KAAA,EACL,KAAK,GAAG,OAAA,CACV,CAEA,sBAA+B,CAC7B,MAAME,EAAO,KAAK,OAAO,MAAM,kBACzBC,EAAM,KAAK,OAAO,MAAM,aAAe,GACvC5J,EAAQ,KAAK,MACnB,OAAIA,GAAS,EAAU2J,EACnB3J,GAAS,GAAW,KAAK,IAAI2J,EAAO,EAAGC,CAAG,EAC1C5J,GAAS,GAAW,KAAK,IAAI2J,EAAO,EAAGC,CAAG,EACvC,KAAK,IAAID,EAAO,EAAGC,CAAG,CAC/B,CAEA,gBAAuB,CAErB,MAAMC,EADa7M,EAAE,UAAU,GACF,SAAW,GACxC,WAAW,IAAM,CACX,KAAK,iBAAmB6M,GAC1B,KAAK,UAAA,EACL,WAAW,IAAM,KAAK,OAAO,QAAA,EAAW,GAAG,GAE3C,KAAK,OAAO,QAAA,CAEhB,EAAG,GAAG,CACR,CAEA,UAAiB,CACf,aAAa,WAAW,gBAAgB,EACxC,MAAMC,EAAa9M,EAAE,YAAY,EAC3B+M,EAAa/M,EAAE,YAAY,EAC3BgN,EAAYhN,EAAE,WAAW,EACzBiN,EAAgBjN,EAAE,eAAe,EACnC8M,IAAYA,EAAW,YAAc,OAAO,KAAK,KAAK,GACtDC,IAAYA,EAAW,YAAc,OAAO,KAAK,OAAO,KAAK,GAC7DC,IAAWA,EAAU,YAAc,OAAO,KAAK,OAAO,IAAI,GAC1DC,GAAeA,EAAc,UAAU,IAAI,MAAM,CACvD,CAEA,SAAgB,CACd,KAAK,cAAc,KAAA,EACnB,KAAK,iBAAiB,KAAA,EACtB,KAAK,aAAa,MAAA,EAClB,KAAK,MAAQ,EACb,KAAK,OAAS,EACd,KAAK,QAAU,KACf,KAAK,SAAW,GAChB,KAAK,WAAa,EAClB,aAAa,WAAW,gBAAgB,EACxC,MAAMA,EAAgBjN,EAAE,eAAe,EACjCuM,EAAYvM,EAAE,WAAW,EAC3BiN,GAAeA,EAAc,UAAU,OAAO,MAAM,EACpDV,MAAqB,UAAY,gBACrC,KAAK,GAAG,WAAW,CAAE,OAAQ,GAAM,MAAO,GAAM,KAAM,GAAM,UAAW,GAAO,KAAM,GAAM,EAC1F,KAAK,GAAG,uBAAuB,CAAC,EAChC,KAAK,GAAG,OAAA,EACR,WAAW,IAAM,KAAK,QAAA,EAAW,GAAG,CACtC,CAEA,SAAgB,CACd,KAAK,OAAO,QAAA,CACd,CACA,QAAe,CACb,KAAK,OAAO,OAAA,CACd,CACA,SAAStM,EAAkB,CACzB,KAAK,OAAO,SAASA,CAAE,CACzB,CACA,eAAsB,CACpB,KAAK,OAAO,iBAAA,CACd,CACA,QAAQgC,EAAmB,CACzB,KAAK,iBAAiB,QAAQA,CAAG,CACnC,CACA,gBAAgBhC,EAAkB,CAChC,KAAK,iBAAiB,gBAAgBA,CAAE,CAC1C,CACA,cAAqB,CACnB,KAAK,iBAAiB,aAAA,CACxB,CACA,YAAYgC,EAAmB,CAC7B,KAAK,iBAAiB,YAAYA,CAAG,CACvC,CACA,YAAmB,CACjB,KAAK,iBAAiB,WAAA,CACxB,CACA,eAAsB,CACpB,KAAK,GAAG,cAAA,CACV,CACA,cAAqB,CACnB,KAAK,GAAG,aAAA,CACV,CACA,eAAsB,CACpB,KAAK,GAAG,cAAA,CACV,CACA,iBAAwB,CACtB,KAAK,GAAG,gBAAA,CACV,CACA,WAAkB,CAChB,KAAK,GAAG,UAAA,CACV,CACA,kBAAkBiL,EAAiC,CACjD,KAAK,GAAG,kBAAkBA,CAAG,CAC/B,CACA,UAAUA,EAA2BjN,EAAkB,CACrD,KAAK,iBAAiB,UAAUiN,EAAKjN,CAAE,CACzC,CACA,YAAYiN,EAAiC,CAC3C,KAAK,cAAc,YAAYA,CAAG,EAClC,KAAK,KAAA,EACL,KAAK,GAAG,OAAA,EACR,KAAK,GAAG,kBAAkBA,CAAG,EAC7B,KAAK,GAAG,IAAI,UAAU,CACxB,CACA,WAAWjN,EAAkB,CAC3B,MAAMkN,EAAW,KAAK,cAAc,WAAWlN,CAAE,EAC3CmB,EAAQ,KAAK,OAAO,OAAO,KAAKF,GAAKA,EAAE,KAAOjB,CAAE,EAClDkN,GAAY/L,GAAO,KAAK,GAAG,IAAI,MAAM+L,CAAQ,UAAU/L,EAAM,IAAI,EAAE,EACvE,KAAK,KAAA,EACL,KAAK,GAAG,gBAAA,EACR,KAAK,GAAG,gBAAA,CACV,CACA,aAAaa,EAAmB,CAC9B,KAAK,cAAc,aAAaA,CAAG,EACnC,KAAK,KAAA,EACL,KAAK,GAAG,gBAAA,EACR,KAAK,GAAG,gBAAA,CACV,CACA,YAAYhC,EAAkB,CAC5B,KAAK,OAAO,cAAgBA,EAC5B,KAAK,KAAA,EACL,KAAK,GAAG,gBAAA,EACR,KAAK,GAAG,cAAA,CACV,CACA,mBAA0B,CACxB,KAAK,GAAG,kBAAA,CACV,CACA,iBAAwB,CACtB,KAAK,GAAG,gBAAA,CACV,CACA,eAAsB,CACpB,KAAK,GAAG,cAAA,CACV,CACA,iBAAwB,CACtB,KAAK,GAAG,gBAAA,CACV,CACA,WAAWmN,EAAe1L,EAAsB,CAC9C,MAAM6B,EAAM,KAAK,OAAO,KAAK,KAAM8J,GAAWA,EAAE,KAAOD,CAAK,EAC5D,GAAI,CAAC7J,GAAO,CAACA,EAAI,KAAM,OACvB,MAAM+J,EAAW/J,EAAI,KAAK,KAAKrC,GAAKA,EAAE,SAAWQ,CAAM,EACvD,GAAK4L,EACL,IAAI,KAAK,OAAO,KAAOA,EAAS,MAAO,CACrC,KAAK,GAAG,IAAI,UAAU,EACtB,MACF,CACA,KAAK,OAAO,MAAQA,EAAS,MAC7B,KAAK,iBAAiB,QAAQ5L,EAAQ,CAAC,EACvC,KAAK,GAAG,IAAI,WAAW,EACvB,KAAK,KAAA,EACL,KAAK,GAAG,OAAA,EACV,CACA,gBAAgB0L,EAAqB,CACnC,MAAM7J,EAAM,KAAK,OAAO,KAAK,KAAM8J,GAAWA,EAAE,KAAOD,CAAK,EAC5D,GAAI,CAAC7J,EAAK,OACV,MAAMO,EAAS,KAAK,aAAa,iBAAiBP,CAAG,EACrD,KAAK,aAAa,YAAYO,CAAM,EACpC,KAAK,GAAG,cAAA,EACJA,EAAO,KAAO,GAAG,KAAK,GAAG,IAAI,SAASA,EAAO,IAAI,KAAK,EACtDA,EAAO,IAAM,GAAG,KAAK,GAAG,IAAI,QAAQA,EAAO,GAAG,KAAK,EACnDA,EAAO,MAAM,OAAS,GAAG,KAAK,GAAG,IAAI,SAAS,EAClD,KAAK,KAAA,EACL,KAAK,GAAG,OAAA,CACV,CACA,YAAYgB,EAAayI,EAAsB,CAC7C,KAAK,GAAG,YAAYzI,EAAKyI,CAAE,CAC7B,CACA,cAAqB,CACnB,KAAK,GAAG,aAAA,CACV,CACA,eAAetL,EAAmB,CAChC,KAAK,GAAG,eAAeA,CAAG,CAC5B,CACF,CCtTA,eAAeuL,GAAkC,CAE/C,MAAMC,EAAM,MAAM,MADsB,mBACL,yBAA2B,KAAK,KAAK,EACxE,GAAI,CAACA,EAAI,GAAI,MAAM,IAAI,MAAM,QAAQ,EACrC,OAAOA,EAAI,KAAA,CACb,CAEA,SAASC,EAAYvN,EAAkB,CACrC,SAAS,iBAAiB,QAAQ,EAAE,QAAQwN,GAAS,CACnDA,EAAM,iBAAiB,QAASvJ,GAAK,CAC/BA,EAAE,SAAWuJ,IACXA,EAAM,KAAO,gBACfxN,EAAK,QAAA,EAELwN,EAAM,UAAU,OAAO,MAAM,EAGnC,CAAC,CACH,CAAC,CACH,CAEAH,IACG,KAAKrB,GAAU,CACd,MAAMhM,EAAO,IAAI+L,EAAKC,CAAM,EAC5B,OAAO,KAAOhM,EACdA,EAAK,KAAA,EACLuN,EAAYvN,CAAI,CAClB,CAAC,EACA,MAAMiE,GAAK,CACV,MAAM,UAAYA,EAAE,OAAO,CAC7B,CAAC"}