<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LoopingEve - 循环冒险</title>
    <link rel="stylesheet" href="style.css?v=8">
</head>
<body>
    <div class="game-container">
        <header class="game-header">
            <h1>⚔️ LoopingEve</h1>
            <div class="header-right">
                <div class="header-gold">
                    <span class="label">💰</span>
                    <span id="playerGold">0</span>
                </div>
                <button class="btn btn-settings" id="btnSettings">⚙️</button>
            </div>
        </header>
        
        <div class="status-bar">
            <div class="status-item atk">
                <div class="label">⚔️</div>
                <div class="value" id="playerATK">12</div>
            </div>
            <div class="status-item def">
                <div class="label">🛡️</div>
                <div class="value" id="playerDEF">6</div>
            </div>
            <div class="bar-row">
                <span class="bar-icon hp-icon">❤️</span>
                <div class="bar-track hp-track">
                    <div class="bar-fill hp-fill" id="hpFill" style="width: 100%"></div>
                    <span class="bar-value hp-value"><span id="playerHP">120</span>/<span id="playerMaxHP">120</span></span>
                </div>
            </div>
            <div class="bar-row">
                <span class="bar-icon exp-icon">⭐</span>
                <div class="bar-track exp-track">
                    <div class="bar-fill exp-fill" id="expBar" style="width: 0%"></div>
                    <span class="bar-value exp-value">Lv.<span id="playerLevel">1</span> <span id="playerEXP">0</span>/<span id="playerMaxEXP">50</span></span>
                </div>
            </div>
        </div>
        
        <main class="battle-area">
            <div class="equipment-row">
                <div class="equip-slot">
                    <span class="icon">🗡️</span>
                    <span class="name" id="playerWeapon">无</span>
                </div>
                <div class="equip-slot">
                    <span class="icon">🛡️</span>
                    <span class="name" id="playerArmor">无</span>
                </div>
            </div>
            
            <div class="monster-area">
                <div class="floor-info">
                    <span class="floor-label">第</span>
                    <span id="currentFloor">1</span>
                    <span class="floor-label">层</span>
                </div>
                <div class="kill-progress" id="killProgress">-/-</div>
                <div class="monster-card">
                    <div class="monster-avatar" id="monsterAvatar">❓</div>
                    <div class="monster-name" id="monsterName">等待探索...</div>
                    <div class="monster-hp-bar">
                        <div class="monster-hp-fill" id="monsterHPFill" style="width: 100%"></div>
                    </div>
                    <div class="monster-hp-text"><span id="monsterHP">0</span>/<span id="monsterMaxHP">0</span></div>
                </div>
            </div>
            
            <div class="battle-log" id="battleLog">
                <p>游戏加载中...</p>
            </div>
        </main>
        
        <div class="action-area">
            <div class="battle-actions">
                <button class="btn btn-attack" id="btnAttack" disabled>⚔️ 攻击</button>
                <button class="btn btn-skill" id="btnSkill" disabled>✨ <span id="currentSkillName">强力打击</span></button>
                <button class="btn btn-item" id="btnItem" disabled>🧪 血瓶</button>
                <button class="btn btn-next" id="btnNextFloor" disabled>⬆️ 下一层</button>
            </div>
            <div class="info-actions">
                <button class="btn btn-inventory" id="btnInventory">🎒 背包</button>
                <button class="btn btn-skill-list" id="btnSkillList">✨ 技能</button>
                <button class="btn btn-forge" id="btnForge">🔨 锻造</button>
                <label class="auto-next">
                    <input type="checkbox" id="autoNext">
                    <span>自动下层</span>
                </label>
            </div>
        </div>
    </div>
    
    <div class="modal" id="settingsModal">
        <div class="modal-content settings-modal">
            <h2>⚙️ 设置</h2>
            <div class="settings-list">
                <button class="btn btn-danger settings-btn" id="btnClear2">🗑️ 重置游戏</button>
            </div>
            <button class="btn btn-primary close-btn" onclick="document.getElementById('settingsModal').classList.remove('show')">关闭</button>
        </div>
    </div>
    
    <div class="modal" id="confirmModal">
        <div class="modal-content confirm-modal">
            <h2>⚠️ 确认操作</h2>
            <p id="confirmMessage" style="margin: 20px 0;">确定要执行此操作吗？</p>
            <div class="confirm-buttons">
                <button class="btn btn-cancel" onclick="game.closeConfirm()">取消</button>
                <button class="btn btn-danger" id="confirmBtn">确定</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="itemModal">
        <div class="modal-content item-use-modal">
            <h2>🧪 使用道具</h2>
            <div id="itemList"></div>
            <button class="btn btn-primary close-btn" onclick="document.getElementById('itemModal').classList.remove('show')">关闭</button>
        </div>
    </div>
    
    <div class="modal" id="skillModal">
        <div class="modal-content skill-modal">
            <h2>✨ 技能</h2>
            <div id="skillMenuContent"></div>
            <button class="btn btn-primary close-btn" onclick="document.getElementById('skillModal').classList.remove('show')">关闭</button>
        </div>
    </div>
    
    <div class="modal" id="skillManageModal">
        <div class="modal-content skill-manage-modal">
            <h2>⚙️ 技能管理</h2>
            <div id="skillManageContent"></div>
            <button class="btn btn-primary close-btn" onclick="document.getElementById('skillManageModal').classList.remove('show')">关闭</button>
        </div>
    </div>
    
    <div class="modal" id="inventoryModal">
        <div class="modal-content inventory-modal">
            <h2>🎒 背包</h2>
            <div id="inventoryContent"></div>
            <button class="btn btn-primary close-btn" onclick="document.getElementById('inventoryModal').classList.remove('show')">关闭</button>
        </div>
    </div>
    
    <div class="modal" id="forgeModal">
        <div class="modal-content forge-modal">
            <h2>🔨 锻造</h2>
            <div id="forgeContent"></div>
            <button class="btn btn-primary close-btn" onclick="document.getElementById('forgeModal').classList.remove('show')">关闭</button>
        </div>
    </div>
    
    <div class="modal" id="levelUpModal">
        <div class="modal-content">
            <h2>🎉 升级！</h2>
            <p style="font-size: 1.2rem; margin: 15px 0;">升到 <strong style="color: var(--accent);" id="newLevel">2</strong> 级</p>
            <div class="level-up-stats">
                <p>❤️ 生命 <span id="levelUpHP">+15</span></p>
                <p>⚔️ 攻击 <span id="levelUpATK">+3</span></p>
                <p>🛡️ 防御 <span id="levelUpDEF">+2</span></p>
            </div>
            <button class="btn btn-primary" onclick="game.closeLevelUpModal()">继续冒险</button>
        </div>
    </div>
    
    <div class="modal" id="gameOverModal">
        <div class="modal-content">
            <h2>💀 战败</h2>
            <p style="margin: 15px 0;">你在第 <strong style="color: var(--danger);" id="finalFloor">1</strong> 层倒下了</p>
            <p>最终等级: <strong style="color: var(--accent);" id="finalLevel">1</strong></p>
            <p>获得金币: <strong style="color: var(--accent);" id="finalGold">0</strong></p>
            <button class="btn btn-primary" style="margin-top: 15px;" onclick="game.restart()">重新开始</button>
        </div>
    </div>
    
    <script src="js/UIManager.js?v=3"></script>
    <script src="js/PlayerManager.js?v=1"></script>
    <script src="js/InventoryManager.js?v=1"></script>
    <script src="js/BattleManager.js?v=3"></script>
    <script src="js/Game.js?v=10"></script>
    
    <script>
    setupModals();
    </script>
</body>
</html>
